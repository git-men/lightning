(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"33sl":function(e,t,a){"use strict";a.d(t,"b",(function(){return p}));var n=a("0Owb"),r=a("k1fw"),i=a("oBTY"),l=a("q1tI"),u=a.n(l),c=a("9Ndd"),o=a("Z8En"),d=a("jfUH"),s=["string","integer","float","bool","date","datetime"].concat(Object(i["a"])(d["P"]),["mref","decimal"]),f=Object(r["a"])(Object(r["a"])({},c["b"]),{},{Select:function(e){return u.a.createElement(c["b"].Select,Object(n["a"])({style:{width:"100%"}},e))},Switch:function(e){return u.a.createElement(o["a"],e)}}),p={string:["=","icontains","contains","endswith","startswith"],integer:["=",">",">=","<","<=","in","!="],float:["=",">",">=","<","<="],bool:["="],date:["=","between"],datetime:["=","between"],ref:["=","in","!="],oref:["=","in","!="],boref:["=","in","!="],mref:["=","in","!="],decimal:["=",">",">=","<","<="]},v=function(e){var t=function e(t){var a=t.filter((function(e){return s.includes(e.type)}));return a.map((function(t){var a=t.type,n=t.field,i=Object(r["a"])({operators:p[a],defaultValue:c["d"][a],widget:f[c["e"][a]],widgetProps:{},label:n},t);return t.children&&(i.children=e(t.children)),i}))};return t(e)};t["a"]=v},"Id/g":function(e,t,a){e.exports={groupContainer:"groupContainer___29RtY"}},"MQ/l":function(e,t,a){e.exports={"icon-div":"icon-div___J-9CX",icon:"icon___3Chhw",groupContainer:"groupContainer___3dl3E"}},NVqa:function(e,t,a){"use strict";a.d(t,"c",(function(){return R})),a.d(t,"e",(function(){return ne})),a.d(t,"d",(function(){return ce})),a.d(t,"a",(function(){return oe["a"]})),a.d(t,"f",(function(){return de["b"]})),a.d(t,"b",(function(){return pe}));a("e+1C");var n=a("Nd5c"),r=(a("ER8q"),a("Ai5L")),i=(a("eE3J"),a("GSZB")),l=a("PpiC"),u=a("k1fw"),c=a("fWQN"),o=a("mtLc"),d=a("yKVA"),s=a("879j"),f=a("q1tI"),p=a.n(f),v=a("4b23"),m=a.n(v),h=a("LvDl"),y=a("jfUH"),b=(a("UvA9"),a("u4G2")),g=(a("vmZS"),a("NjVP")),j=a("0Owb"),O=(a("4X2C"),a("xvon")),E=a("tJVT"),C=(a("yavW"),a("WuMn")),k=a("Nmjv"),w=C["a"].Option,S=[{name:"string",label:"\u5b57\u7b26\u4e32"},{name:"int",label:"\u6574\u6570"},{name:"decimal",label:"\u6d6e\u70b9\u6570"},{name:"boolean",label:"\u5e03\u5c14\u503c"},{name:"array",label:"\u6570\u7ec4"},{name:"object",label:"\u5bf9\u8c61"}],V=[{name:"object",label:"\u5bf9\u8c61"},{name:"int",label:"id"}],x=function(){},N={name:"",type:"string",default:void 0,desc:"",required:!1,isShowDefalut:!1},D=0,I=function(e){var t=e.id,a=e.children,l=e.onAddChlidren,c=void 0===l?x:l,o=e.onDelete,d=void 0===o?x:o,s=e.typeDisabled,v=e.typeData,m=void 0===v?S:v,h=e.onChange,y=e.value,I=void 0===y?N:y;D+=1;var A=Object(f["useContext"])(k["a"]),_=Object(f["useState"])(I),T=Object(E["a"])(_,2),R=T[0],q=T[1];console.log("".concat(t,"  ParameterItem ").concat(D," "));var L=function(){h&&h(R)};function P(e,t){"type"===e&&(R.default=void 0,"bool"!==t&&"boolean"!==t||(R.default=!1));var a=Object(u["a"])({},R);a[e]=t,"type"!==e||"array"!==t&&"object"!==t||(a.arrayType="object"),q(Object(u["a"])({},a))}Object(f["useEffect"])((function(){L()}),[R.type,R.required,R.arrayType]);var K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{l:24,w:24},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r;return{labelCol:{xs:{span:e.l},sm:{span:t.l},md:{span:a.l},lg:{span:n.l},xl:{span:r.l},xxl:{span:i.l}},wrapperCol:{xs:{span:e.w},sm:{span:t.w},md:{span:a.w},lg:{span:n.w},xl:{span:r.w},xxl:{span:i.w}}}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r;return{xs:{span:e},sm:{span:t},md:{span:a},lg:{span:n},xl:{span:r},xxl:{span:i}}},B=R.type&&"array"===R.type,G="array"===R.type||"object"===R.type,W=!0;A&&(W=!!R.name);var J=function(){return W?"success":"error"},U=function(){return W?null:p.a.createElement("div",{style:{color:"red",fontSize:12}},"\u53c2\u6570\u540d\u4e0d\u80fd\u4e3a\u7a7a")},H={onBlur:L,style:{width:"100%"}};"bool"!==R.type&&"boolean"!==R.type||(H.type="min");var Q={xs:8,sm:1,md:8,xl:4,xxl:2},M=R.isShowDefalut,Y=void 0!==M&&M,Z=0;Y&&(Z=2);var F=Object(f["useMemo"])((function(){return p.a.createElement("div",null,p.a.createElement(n["a"],{gutter:Q,align:"middle"},p.a.createElement(r["a"],z(24,5),p.a.createElement(g["a"].Item,Object(j["a"])({},K({l:24,w:24},{l:10,w:14}),{label:"\u53c2\u6570\u540d",required:!0,validateStatus:J(),extra:U()}),p.a.createElement(O["a"],{name:"name",placeholder:"\u8bf7\u8f93\u5165",value:R.name,onChange:function(e){P("name",e.target.value)},onBlur:function(){L()}}))),p.a.createElement(r["a"],z(24,4),p.a.createElement(g["a"].Item,Object(j["a"])({},K({l:24,w:24},{l:8,w:16}),{label:"\u7c7b\u578b"}),p.a.createElement(C["a"],{name:"type",placeholder:"\u8bf7\u9009\u62e9",defaultValue:"string",value:R.type,style:{width:"100%"},disabled:s,onChange:function(e){P("type",e)},validateStatus:"success"},m.map((function(e){return p.a.createElement(w,{key:e.name,value:e.name},e.label)}))))),B&&p.a.createElement(r["a"],z(24,5),p.a.createElement(g["a"].Item,Object(j["a"])({label:"\u6570\u7ec4\u5143\u7d20"},K({l:24,w:24},{l:10,w:14})),p.a.createElement(C["a"],{name:"arrayType",placeholder:"\u8bf7\u9009\u62e9",defaultValue:"string",value:R.arrayType,style:{width:"100%"},onChange:function(e){P("arrayType",e)}},V.map((function(e){return p.a.createElement(w,{key:e.name,value:e.name},e.label)}))))),!G&&p.a.createElement(r["a"],z(24,4),p.a.createElement(g["a"].Item,Object(j["a"])({},K({l:24,w:24},{l:8,w:16}),{label:"\u8bf4\u660e"}),p.a.createElement(O["a"],{name:"desc",placeholder:"\u8bf7\u8f93\u5165",value:R.desc,onChange:function(e){P("desc",e.target.value)},onBlur:function(){L()}}))),!G&&p.a.createElement(r["a"],z(24,4+Z,4+Z,3+Z),p.a.createElement(g["a"].Item,null,p.a.createElement("div",{style:{display:"flex"}},p.a.createElement("div",{style:{minWidth:74}},p.a.createElement(b["a"],{name:"isShowdefault",checked:Y,onChange:function(e){P("isShowDefalut",e.target.checked)}},"\u9ed8\u8ba4\u503c")),Y&&p.a.createElement("div",null,p.a.createElement(de["b"],{componenttype:R.type,name:"default",placeholder:"\u8bf7\u8f93\u5165",value:R.default,widgetonchange:function(e){P("default",e)},widgetProps:H}))))),p.a.createElement(r["a"],z(12,4),p.a.createElement(g["a"].Item,null,p.a.createElement("div",{style:{display:"flex",alignItems:"center",minHeight:40}},!G&&p.a.createElement(b["a"],{name:"required",checked:R.required,onChange:function(e){P("required",e.target.checked)}},"\u5fc5\u586b"),p.a.createElement(i["a"],{type:"close",style:{fontSize:20,width:20,height:20},onClick:d}),G&&p.a.createElement(i["a"],{type:"plus",style:{fontSize:20,marginLeft:10,width:20,height:20},onClick:c}))))),p.a.createElement(n["a"],null,p.a.createElement(r["a"],{span:23,offset:1},a)))}),[R,a,e]);return F},A=I,_={name:"",type:"string",default:void 0,desc:"",required:!0,isShowDefalut:!1},T=function(e){Object(d["a"])(a,e);var t=Object(s["a"])(a);function a(e){var n;Object(c["a"])(this,a),n=t.call(this,e),n.parameterOnChange=function(e,t){var a=n.state.parameterValues,r=a;r[e].value=t,n.setState({parameterValues:r},n.updateValue)},n.addItem=function(){console.log("addItem");var e=n.state.parameterValues,t=e,a={id:m()(),pid:-1,value:Object(u["a"])({},_)};t[a.id]=a,n.setState({parameterValues:t},n.updateValue)},n.onAddChlidren=function(e){if(void 0!==e&&null!==e){console.log("onAddChlidren",e);var t=n.state.parameterValues,a=t,r={id:m()(),pid:e,value:Object(u["a"])({},_)};a[r.id]=r,n.setState({parameterValues:a},n.updateValue)}},n.onDelete=function(e){if(void 0!==e&&null!==e){console.log("onDelete",e);var t=n.state.parameterValues,a=t;delete a[e],n.setState({parameterValues:a},n.updateValue)}},n.toTree=function(e){var t=n.state.parameterValues;return e.map((function(e){var a=e.id,r=e.pid,i=e.value,l=e.children,u={id:a,pid:r,key:a,value:i},c=t[e.pid],o=!(!c||!c.value.arrayType||"int"!==c.value.arrayType),d=!!Object(h["findKey"])(t,(function(t){return t.pid===e.id}));return o&&(d=!0,u.value.type="int"),u.onChange=function(e){n.parameterOnChange(a,e)},u.onAddChlidren=function(){n.onAddChlidren(a)},u.onDelete=function(){n.onDelete(a)},u.typeDisabled=d,l&&(u.children=n.toTree(l)),u}))};var r=n.props.value,i=void 0===r?{}:r;return n.state={parameterValues:i},n}return Object(o["a"])(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.value,a=void 0===t?{}:t,n=e.schemas,r=e.model,i=e.operation,l=e.isNew;if(Object(h["isEmpty"])(a)&&"create"===i&&l){var u=n[r].fields.filter((function(e){return e.required}));this.initItems(u)}}},{key:"componentDidUpdate",value:function(e){var t=this.props.model,a=e.model;if(t!==a){var n=this.props,r=n.schemas,i=n.operation,l=n.isNew;if("create"===i&&l){var u=r[t].fields.filter((function(e){return e.required}));this.initItems(u)}}}},{key:"initItems",value:function(e,t){var a={},n={string:"string",text:"string",richtext:"string",integer:"int",float:"decimal",decimal:"decimal",bool:"boolean",ref:"object",oref:"object",boref:"object",mref:"array",bref:"array",time:"string",datetime:"string",date:"string",image:"string",file:"string",password:"string"};e.forEach((function(e){var r={};r.name=e.name,r.type=n[e.type],r.default=e.default,r.desc=e.help,r.required=e.required,Object(y["D"])(e)&&(r.type="object",r.arrayType="object"),Object(y["z"])(e)&&(r.type="array",r.arrayType="object");var i={id:m()(),pid:t||-1,value:Object(u["a"])(Object(u["a"])({},_),r)};a[i.id]=i})),this.setState({parameterValues:a},this.updateValue)}},{key:"updateValue",value:function(){var e=this.props.onChange;if(e){var t=this.state.parameterValues;e(t)}}},{key:"render",value:function(){var e=this.state.parameterValues,t=Object(k["m"])(e),a=this.toTree(t),u=function e(t){return t.map((function(t){var a=t.children,n=Object(l["a"])(t,["children"]);return p.a.createElement(A,n,!!a&&e(a))}))};return p.a.createElement("div",null,p.a.createElement(n["a"],{align:"middle",type:"flex",style:{paddingBottom:15}},p.a.createElement(r["a"],null,p.a.createElement("span",{style:{fontSize:26,marginRight:15}},"\u63a5\u53e3\u53c2\u6570"),p.a.createElement(i["a"],{type:"plus-circle",style:{fontSize:26},onClick:this.addItem}))),u(a))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.value,n=void 0===a?{}:a,r=e.isNew,i=t.parameterValues;return!r&&Object(h["isEmpty"])(i)&&n!==i?Object(u["a"])(Object(u["a"])({},t),{},{parameterValues:n}):null}}]),a}(f["Component"]),R=T,q=a("oBTY"),L=a("tS8v"),P=a("Wwog"),K=(a("lNFX"),a("VE2L")),z=a("9Ndd"),B=(a("o0Ez"),a("MQ/l")),G=a.n(B),W=C["a"].Option,J=g["a"].Item,U=z["b"].Select,H=[{key:"constant",label:"\u5e38\u91cf\u503c"},{key:"variable",label:"\u53c2\u6570\u503c"},{key:"system",label:"\u53d8\u91cf\u503c"}],Q=[{key:"constant",label:"\u5e38\u91cf\u503c"},{key:"system",label:"\u53d8\u91cf\u503c"}],M=H,Y=[],Z=function(e){Object(d["a"])(a,e);var t=Object(s["a"])(a);function a(e){var n;Object(c["a"])(this,a),n=t.call(this,e),n.valueChange=function(e,t){var a=n.state.fieldValue,r=a;if("type"===e){r.value=void 0;var i=n.props.fieldNames,l=a.name&&i.find((function(e){return e.key===a.name})),u=a.name&&l.type;"bool"===u&&(r.value=!1),"variable"!==t&&"system"!==t||(r.value=[])}if("name"===e){var c=n.props,o=c.fieldNames,d=c.addItems,s=c.id,f=c.isNested,p=void 0===f||f,v=o.find((function(e){return e.key===t})),m=!v.isLeaf;if(m){var h=n.props.hideVariable,y=void 0!==h&&h;y||(r.type="variable");var b=v.ref;p&&d(s,b)}}r[e]=t,n.setState({fieldValue:r},n.updateValue)};var r=n.props.values;return n.state={fieldValue:r},n}return Object(o["a"])(a,[{key:"updateValue",value:function(){var e=this.state.fieldValue,t=this.props.onChange;t&&t(e)}},{key:"render",value:function(){var e=this,t=this.props,a=t.fieldNames,l=t.systemData,u=t.children,c=t.onDelete,o=t.onAddChlidren,d=t.nameDisabled,s=void 0!==d&&d,f=t.dollarData,v=void 0===f?Y:f,m=t.dollarChangeOnSelect,h=void 0===m||m,b=t.hideVariable,O=void 0!==b&&b,E=t.isNested,k=void 0===E||E,w=this.state.fieldValue,S=this.context,V=w.name&&!a.find((function(e){return e.key===w.name})).isLeaf,x=function(e,t){return{labelCol:{sm:{span:e||8},xs:{span:24}},wrapperCol:{sm:{span:t||16},xs:{span:24}}}},N=function(e){return{sm:{span:e||4},xs:{span:24}}},D=w.name?{value:w.name}:{},I=w.value?{value:w.value}:{},A=w.name&&a.find((function(e){return e.key===w.name})),_=w.name&&A.type,T="bool"===_&&"constant"===w.type;O&&(M=Q);var R=!0,q=!0;S&&(R=w.name,q=0===w.value||!1===w.value||w.value,Array.isArray(w.value)&&(q=!!w.value.length));var L=function(e){return e?"success":"error"},P=function(e,t){return e?null:p.a.createElement("div",{style:{color:"red",fontSize:12}},t)},B=function(t){var a=p.a.createElement(de["b"],{className:"select-input-value",style:{width:"100%"},value:w.value,componenttype:_,widgetonchange:function(t){e.valueChange("value",t)}});if("constant"===w.type&&t){if("bool"===t.type)return a;var n=z["b"][z["e"][t.type]],r={className:"select-input-value",style:{width:"100%"}};return T&&(delete r.className,delete r.style),"integer"!==t.type&&"decimal"!==t.type||(r.type="number"),void 0!==t.choices&&(r.choices=t.choices,n=U),p.a.createElement(n,Object(j["a"])({},r,{value:w.value,field:t,onChange:function(t){e.valueChange("value",t)}}))}return"constant"===w.type?a:null};return p.a.createElement("div",null,p.a.createElement(n["a"],null,p.a.createElement(r["a"],N(6),p.a.createElement(J,Object(j["a"])({label:"\u5b57\u6bb5"},x(6,18),{required:!0,validateStatus:L(R),extra:P(R,"\u5b57\u6bb5\u4e0d\u80fd\u4e3a\u7a7a")}),p.a.createElement(C["a"],Object(j["a"])({showSearch:!0,name:"name",style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9",onChange:function(t){e.valueChange("name",t)},disabled:s},D,{filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}}),a.map((function(e){return p.a.createElement(W,{key:e.key,value:e.key},e.label)}))))),p.a.createElement(r["a"],N(12),p.a.createElement(J,Object(j["a"])({label:"\u503c"},x(2,22),{className:"item-style"}),p.a.createElement("div",{style:{display:"flex",alignItems:"flex-start"}},p.a.createElement("div",{style:{width:"20%",marginRight:"1%"}},p.a.createElement(J,null,p.a.createElement(C["a"],{name:"type",className:"select-type",defaultValue:"constant",placeholder:"\u8bf7\u9009\u62e9",value:w.type,onChange:function(t){e.valueChange("type",t)}},M.map((function(e){return p.a.createElement(W,{key:e.key,value:e.key},e.label)}))))),p.a.createElement("div",{style:{width:"75%"}},p.a.createElement(J,{required:!0,validateStatus:L(q),extra:P(q,"\u503c\u4e0d\u80fd\u4e3a\u7a7a")},B(A),"variable"===w.type&&p.a.createElement(K["a"],Object(j["a"])({style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9",className:"select-value"},I,{onChange:function(t){e.valueChange("value",t)},defaultValue:[],displayRender:function(e){return e.join(".")},options:v,changeOnSelect:h})),"system"===w.type&&p.a.createElement(K["a"],Object(j["a"])({style:{width:"100%"},name:"value",className:"select-value",placeholder:"\u8bf7\u9009\u62e9",displayRender:function(e){return e.join(".")},onChange:function(t){e.valueChange("value",t)},defaultValue:[],loadData:function(){return{label:"id",value:"id"}},options:l.filter((function(e){return"user"!==e.value||A&&Object(y["D"])(A)})),changeOnSelect:!0},I))))))),p.a.createElement(r["a"],{span:1},p.a.createElement(g["a"].Item,x(0,24),p.a.createElement(i["a"],{className:G.a.icon,type:"close",style:{fontSize:18,margin:"auto"},onClick:c}))),V&&k&&p.a.createElement(r["a"],{span:1},p.a.createElement(g["a"].Item,null,p.a.createElement(i["a"],{className:G.a.icon,type:"plus",style:{fontSize:18},onClick:o})))),p.a.createElement(n["a"],null,p.a.createElement(r["a"],{span:23,offset:1},u)))}}]),a}(f["PureComponent"]);Z.contextType=k["a"];var F=Z,$=a("hjOt"),X=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return $["b"].apply(void 0,t.concat([function(e){return!Object(y["z"])(e)}]))},ee=function(e){return p.a.createElement(F,e)},te={name:void 0,value:void 0,type:"constant"},ae=function(e){Object(d["a"])(a,e);var t=Object(s["a"])(a);function a(e){var n;Object(c["a"])(this,a),n=t.call(this,e),n.onAddChlidren=function(e){if(void 0!==e&&null!==e){var t=n.props.schemas,a=n.state.fieldValues,r=a,i=r[e],l=i.fieldNames.find((function(e){return e.key===i.value.name})).ref,c=X(t,l),o={id:m()(),pid:e,value:Object(u["a"])({},te),fieldNames:c};r[o.id]=o,n.setState({fieldValues:r},n.updateValue)}},n.addItems=function(e,t){var a=n.props.schemas,r=a[t].fields.filter((function(e){return e.required}));n.initItems(!1,r,a,t,e)},n.onDelete=function(e){if(void 0!==e&&null!==e){var t=n.state.fieldValues,a=t;delete a[e],n.setState({fieldValues:a})}},n.addItem=function(){var e=n.state.fieldValues,t=n.props,a=t.schemas,r=t.model,i=e,l=X(a,r),c={id:m()(),pid:-1,value:Object(u["a"])({},te),fieldNames:l};i[c.id]=c,n.setState({fieldValues:i},n.updateValue)},n.updateValue=function(){var e=n.props.onChange;if(e){var t=n.state.fieldValues;e(t)}},n.fieldItemOnChange=function(e,t){var a=n.state.fieldValues,r=a;r[e].value=t,n.setState({fieldValues:r},n.updateValue)},n.treeNode=Object(P["a"])((function(e){var t=n.props,a=t.getParameterValue,r=void 0===a?function(){return[]}:a,i=t.hideVariable,l=t.systemData,u=t.isNested,c=void 0===u||u,o=r(),d=n.state.fieldValues,s=e.id,f=e.pid,p=Object(L["a"])(n),v=p.fieldItemOnChange,m=p.onAddChlidren,b=p.onDelete,g=p.addItems,j={id:s,pid:f,key:s};j.nameDisabled=!!Object(h["findKey"])(d,(function(t){return t.pid===e.id}));var O,E=d[e.pid];if(j.dollarChangeOnSelect=!0,j.fieldNames=e.fieldNames,j.values=e.value,j.dollarData=Object($["a"])({dollarData:o}),j.systemData=l,j.hideVariable=i,j.isNested=c,j.onChange=function(t){v(e.id,t)},j.onAddChlidren=function(){m(e.id)},j.onDelete=function(){b(e.id)},j.addItems=g,e.value.name){var C=e.fieldNames.find((function(t){return t.key===e.value.name})),k=C.type;Object(y["A"])(k)&&(O=k)}return"variable"!==e.value.type||Object(h["isEmpty"])(E)||Object(h["isEmpty"])(E.value.value)||(j.dollarData=Object($["a"])({parent:Object(q["a"])(E.value.value).pop(),nameType:O,dollarData:o}),j.dollarChangeOnSelect=!1),e.children&&(j.children=n.toTree(e.children)),j})),n.toTree=Object(P["a"])((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return n.treeNode(e)}))}));var r=e.value,i=void 0===r?{}:r;return n.state={fieldValues:i},n}return Object(o["a"])(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.value,a=void 0===t?{}:t,n=e.schemas,r=e.model,i=e.operation,l=e.isNew;if(Object(h["isEmpty"])(a)&&"create"===i&&l){var u=n[r].fields.filter((function(e){return e.required}));this.initItems(!0,u,n,r)}}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.model,n=t.isNested,r=e.model;if(a&&a!==r){var i=this.props,l=i.schemas,u=i.operation,c=i.isNew;if(n&&"create"===u&&c){var o=l[a].fields.filter((function(e){return e.required}));this.initItems(!0,o,l,a)}}}},{key:"initItems",value:function(e,t,a,n,r){var i=this.state.fieldValues,l={};e||(l=Object(u["a"])({},i));var c=Object($["b"])(a,n),o=this.props.hideVariable;t.forEach((function(e){var t={id:m()(),pid:r||-1,value:{name:e.name,type:"variable",value:e.name?[e.name]:[]},fieldNames:c};o&&(t.value.type="system",t.value.value=void 0),l[t.id]=t})),this.setState({fieldValues:l},this.updateValue)}},{key:"render",value:function(){var e=this.state.fieldValues,t=Object(k["m"])(e),a=this.toTree(t),u=function e(t){return t.map((function(t){var a=t.children,n=Object(l["a"])(t,["children"]);return p.a.createElement(ee,Object(j["a"])({key:n.id},n),!!a&&e(a))}))};return p.a.createElement("div",null,p.a.createElement(n["a"],{align:"middle",type:"flex",style:{paddingBottom:15}},p.a.createElement(r["a"],null,p.a.createElement("span",{style:{fontSize:26,marginRight:15}},"\u4fdd\u5b58\u5b57\u6bb5"),p.a.createElement(i["a"],{type:"plus-circle",style:{fontSize:26},onClick:this.addItem}))),u(a))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.value,n=void 0===a?{}:a,r=e.isNew,i=t.fieldValues;return!r&&Object(h["isEmpty"])(i)&&n!==i?Object(u["a"])(Object(u["a"])({},t),{},{fieldValues:n}):null}}]),a}(f["Component"]),ne=ae,re=a("T9E4"),ie=0,le=0,ue=function(e){var t=e.value,a=void 0===t?[]:t,n=e.onChange,r=e.columns,i=e.getVariableData,l=e.hideVariable,c=e.systemData;a&&a.length||(a=[]);var o=function(e){var t=[{operator:"AND",children:e}],a=[],n=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.map((function(t){if(t.children){ie+=1;var r={id:ie,parent:n,condition:t.operator.toUpperCase()};return r.rules=e(t.children,ie),a.push(r),r}return le+=1,Object(u["a"])(Object(u["a"])({},t),{},{id:le})}))};return n(t),a.forEach((function(e){e.rules=e.rules.filter((function(e){return!e.rules}))})),a},d=Object(f["useState"])(o(a)),s=Object(E["a"])(d,2),v=s[0],m=s[1];Object(f["useEffect"])((function(){Object(h["isEmpty"])(v[0].rules)&&!Object(h["isEmpty"])(a)&&m(o(a))}),[a]);var y=function(e){n&&n(e.children)};return p.a.createElement("div",null,p.a.createElement(k["b"].Provider,{value:{VariableData:i,hideVariable:l,systemData:c}},p.a.createElement(re["a"],{onChange:function(e){return y(e)},data:v,columns:r})))},ce=ue,oe=a("q9L5"),de=a("Z8En"),se=(a("vc6j"),a("Q9CN")),fe=(a("xr0V"),g["a"].Item),pe=function(e){Object(d["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(c["a"])(this,a),t.apply(this,arguments)}return Object(o["a"])(a,[{key:"changeValue",value:function(e,t){var a=this.props,n=a.onChange,r=a.value,i=r;i[e]=t,n&&n(i)}},{key:"render",value:function(){var e=this,t=this.props.value;return p.a.createElement("div",null,p.a.createElement(n["a"],{className:"item-style"},p.a.createElement(r["a"],{span:12},p.a.createElement(fe,null,p.a.createElement(O["a"],{name:"name",value:t.name,onChange:function(t){return e.changeValue("name",t.target.value)}}))),p.a.createElement(r["a"],{span:12},p.a.createElement(fe,{label:"\u9ed8\u8ba4\u503c",labelCol:{span:8},wrapperCol:{span:16}},p.a.createElement(se["a"],{name:"default",type:"number",value:t.default,onChange:function(t){return e.changeValue("default",t)}})))))}}]),a}(f["PureComponent"])},Nmjv:function(e,t,a){"use strict";a.d(t,"m",(function(){return g})),a.d(t,"l",(function(){return j})),a.d(t,"i",(function(){return E})),a.d(t,"j",(function(){return C})),a.d(t,"k",(function(){return k})),a.d(t,"h",(function(){return w})),a.d(t,"c",(function(){return S})),a.d(t,"e",(function(){return V})),a.d(t,"f",(function(){return x})),a.d(t,"g",(function(){return N})),a.d(t,"d",(function(){return D})),a.d(t,"b",(function(){return I})),a.d(t,"a",(function(){return A}));var n=a("9og8"),r=a("k1fw"),i=a("WmNS"),l=a.n(i),u=a("Wwog"),c=a("q1tI"),o=a.n(c),d=a("LvDl"),s=a("4b23"),f=a.n(s),p=a("hjOt"),v=a("WiEq"),m=a("v9ey"),h=a("33sl"),y=a("jfUH"),b=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return a.map((function(a){var n=Object(r["a"])({},a),i=t.filter((function(e){return e.pid===a.id})),l=t.filter((function(e){return e.id!==a.id||e.pid!==a.id}));return i.length>0&&(n.showAdd=!0,n.children=e(l,i)),Object(r["a"])({},n)}))},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],a=[];Object.keys(e).forEach((function(n){-1===e[n].pid?a.push(Object(r["a"])({},e[n])):t.push(Object(r["a"])({},e[n]))}));var n=b(t,a);return n},j=Object(u["a"])((function(e,t){var a=[];return Object(d["isEmpty"])(e)||Object(d["isEmpty"])(t)||e[t].fields.forEach((function(e){a.push({key:e.name,label:"".concat(e.name,"\u5347\u5e8f")}),a.push({key:"-".concat(e.name),label:"".concat(e.name,"\u964d\u5e8f")})})),a})),O=function(e,t){var a=g(e),n=function e(a){return a.map((function(a){var n=a.value,i=a.children,l=Object(r["a"])({},t(n));return i&&(l.children=e(i)),l}))};return n(a)},E=function(e){function t(e){var t=e.name,a=e.type,n=e.desc,r=e.required,i=e.arrayType,l={name:t,desc:n,required:r,is_array:!1,type:a};return"array"===a&&(l.is_array=!0,l.type=i),e.isShowDefalut&&(0===e.default||!1===e.default||e.default)&&(l.default=e.default),l}var a=O(e,t);return a},C=function(e){function t(e){var t=e.name,a=e.type,n=e.value,r={name:t};return"constant"===a&&(r.value=n),"variable"===a&&(r.value="$".concat("{",Array.isArray(n)?n.join("."):n,"}")),"system"===a&&(r.value="#{".concat(Array.isArray(n)?n.join("."):n,"}")),r}var a=O(e,t);return a},k=function(e,t){if(Object(d["isEmpty"])(e)||Object(d["isEmpty"])(t))return[];var a=3;function n(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!(i>a)){var l=e[t]&&e[t].fields||[];return l.map((function(e){var t=Object(r["a"])(Object(r["a"])({},e),{},{field:e.name,label:"".concat(e.name,"(").concat(e.displayName,")"),operators:h["b"][e.type],widgetProps:{field:e}});return Object(y["B"])(e)&&(t.type="integer",t.valueParser=function(e){return e.id||e},t.children=n(e.ref,i+1)),t}))}}return n(t)},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];function t(e){return e.map((function(e){var a=e.operator,n=e.value,r=e.field,i=e.type,l=e.children,u={operator:a};if(r&&i){u.field=r;var c={constant:n,variable:"$".concat("{",Array.isArray(n)?n.join("."):n,"}"),system:"#".concat("{",Array.isArray(n)?n.join("."):n,"}")};u.value=c[i]}else l&&(u.children=t(l));return u}))}return t(e)},S=function(){var e=Object(n["a"])(l.a.mark((function e(t,a){var n,i,u,c,o,d,s,h,y,b,g,j,O,E,C,k,w,S,V,x,N,D,I,A,_,T;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.slug,i=t.app,u=t.model,c=t.operation,o=t.summary,d=t.disable,s=t.logined,h=t.name,y=t.groups,b=t.ordering,g=t.func_name,j=t.parameter,O=t.displayfield,E=t.setfield,C=t.filter,c){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,Object(m["c"])();case 5:return k=e.sent,w={name:h,slug:n,app__model:[i,u],summary:o,disable:!d,logined:s,groups:y.map((function(e){return k.find((function(t){return t.id===e}))}))},"func"===c&&(w.func_name=g),"list"===c&&(S=j.find((function(e){return"\u9875\u957f\u53c2\u6570"===e.desc})),V=j.find((function(e){return"\u9875\u7801\u53c2\u6570"===e.desc})),S&&V&&(w.paging=!0,w.size={name:S.name,default:S.default},w.page=V.name),w.ordering=b),v["a"][c].includes("pk")&&(x=j.find((function(e){return"pk"===e.type})),x&&(w.pk=x.name)),v["a"][c].includes("parameter")&&(N=j.filter((function(e){return"pk"!==e.type&&"\u9875\u7801\u53c2\u6570"!==e.desc&&"\u9875\u957f\u53c2\u6570"!==e.desc})),D={},I=function e(t,a){t.forEach((function(t){var n=Object(r["a"])({},t);n.is_array&&(n.arrayType=n.type,n.type="array"),(0===n.default||!1===n.default||n.default)&&(n.isShowDefalut=!0);var i={id:f()(),pid:a||-1,value:n};t.children&&(i.children=e(t.children,i.id)),D[i.id]=i}))},I(N),w.parameter=D),v["a"][c].includes("setfield")&&(A={},_=function e(t,n,l){t.forEach((function(t){var c=Object(r["a"])({},t);c.value=t.value.toString().replace(/[$#{}]/g,""),c.type="constant",t.value.toString().search(/[$]/)>-1&&(c.type="variable"),t.value.toString().search(/#/)>-1&&(c.type="system"),"variable"!==c.type&&"system"!==c.type||(c.value=c.value.split("."));var o={id:f()(),pid:n||-1,value:c};if(o.fieldNames=Object(p["b"])(a,"".concat(i,"__").concat(u)),n){var d=l.fieldNames.find((function(e){return e.key===l.value.name})).ref;o.fieldNames=Object(p["b"])(a,d)}t.children&&(o.children=e(t.children,o.id,o)),A[o.id]=o}))},_(E),w.setfield=A),v["a"][c].includes("filter")&&(T=function e(t){return t.map((function(t){var a=Object(r["a"])({},t);a.value=t.value.toString().replace(/[${}#]/g,""),a.type="constant",t.value.toString().search(/[$]/)>-1&&(a.type="variable"),t.value.toString().search(/#/)>-1&&(a.type="system"),"variable"!==a.type&&"system"!==a.type||(a.value=a.value.split("."));var n=Object(r["a"])({},a);return t.children&&(n.children=e(t.children,n.id)),n}))},w.filter=T(C)),v["a"][c].includes("displayfield")&&(w.displayfield=O),e.abrupt("return",w);case 15:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),V=function(){var e=Object(n["a"])(l.a.mark((function e(t,a,n){return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a.name||!a.default){e.next=2;break}return e.abrupt("return",n());case 2:return e.abrupt("return",n("\u8bf7\u8f93\u5165\u9875\u957f\u53c2\u6570\u548c\u9ed8\u8ba4\u503c"));case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!Object.keys(e).find((function(t){return!e[t].value.name}))},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!Object.keys(e).find((function(t){var a=e[t].value.name;if(Array.isArray(e[t].value.value)&&0===e[t].value.value.length)return!0;var n=0===e[t].value.value||!1===e[t].value.value||!!e[t].value.value;return!a||!n}))},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],a=function e(a){a.forEach((function(a){(0!==a.value&&!1!==a.value&&!a.value||Array.isArray(a.value)&&0===a.value.length)&&t.push(a),a.children&&e(a.children)}))};return a(e),0===t.length},I=o.a.createContext({VariableData:function(){},hideVariable:!1}),A=o.a.createContext(!1)},O9Rr:function(e,t,a){"use strict";a("4csm");var n=a("2Fwu"),r=(a("eE3J"),a("GSZB")),i=(a("9kbU"),a("vbHR")),l=a("q1tI"),u=a.n(l),c=(a("6dnR"),a("CQJL")),o=function(e){var t=e.buttons,a=void 0===t?[{}]:t,n=e.onButtonClick,r=e.value;return u.a.createElement(c["a"].Group,{defaultValue:a[0].value,buttonStyle:"solid",value:r,style:{zIndex:1,position:"relative"}},a.map((function(e){return u.a.createElement(c["a"].Button,{key:e.value,value:e.value,onChange:function(e){return n(e.target.value)}},e.text)})))};o.defaultProps={onButtonClick:function(){}};var d=o,s=(a("e+1C"),a("Nd5c")),f=a("0Owb"),p=(a("ER8q"),a("Ai5L")),v=a("jrin"),m=a("tJVT"),h=(a("lNFX"),a("VE2L")),y=(a("vmZS"),a("NjVP")),b=(a("yavW"),a("WuMn")),g=a("Vtfu"),j=a("Nmjv"),O=a("x7hw"),E=a.n(O),C=(a("fC8i"),b["a"].Option),k=y["a"].Item,w=[{text:"\u5e38\u91cf\u503c",key:"constant"},{text:"\u53c2\u6570\u503c",key:"variable"},{text:"\u53d8\u91cf\u503c",key:"system"}],S=[{text:"\u5e38\u91cf\u503c",key:"constant"},{text:"\u53d8\u91cf\u503c",key:"system"}],V=w,x=function e(t,a){var n=a.find((function(e){return e.field===t.split(".")[0]}));return t.includes(".")?e(t.split(".").slice(1).join("."),n.children):n},N=function(e){var t=e.columns,a=e.rule,n=e.handleDeleteCondition,i=e.handleChangeRule,c=e.cascaderOptions,o=e.context,d=a.field,y=a.operator,O=a.value,w=a.id,N=a.gid,D=a.type,I=x(d,t),A=I.value,_=I.widget,T=I.type,R={variable:[],system:void 0,constant:A},q=y,L=O,P=function(e){var t;switch(e){case"variable":t=h["a"];break;case"system":t=h["a"];break;case"constant":t=_;break;default:t=g["a"];break}return function(){return t}},K=o.VariableData,z=o.hideVariable,B=void 0!==z&&z,G=o.systemData,W=void 0===G?[]:G,J=Object(l["useContext"])(j["a"]),U=Object(l["useState"])(P(D)),H=Object(m["a"])(U,2),Q=H[0],M=H[1];B&&(V=S);var Y=function(e){return function(a){var n,r=D;if("field"===e){a=a.filter((function(e){return void 0!==e})).join(".");var l=x(a,t),u=Object(m["a"])(l.operators,1);q=u[0],r="constant",M((function(){return l.defaultWidget})),l.type!==T&&(L=l.defaultValue)}"type"===e&&(L=R[a]);var c=(n={field:d,operator:q,value:L,type:r},Object(v["a"])(n,e,a),Object(v["a"])(n,"id",w),Object(v["a"])(n,"gid",N),n);i(c)}},Z=function(e){M(P(e)),Y("type")(e)},F=Q||_||g["a"],$={width:"100%"},X={};"variable"===D&&(X.options=[],K&&(X.options=K()),X.displayRender=function(e){return e.join(".")},X.changeOnSelect=!0),"system"===D&&(X.options=W,X.displayRender=function(e){return e.join(".")},X.changeOnSelect=!0);var ee=!0;J&&(ee=!1===O||0===O||!!O);var te=function(e){return e?"success":"error"},ae=function(e,t){return e?null:u.a.createElement("div",{style:{color:"red",fontSize:12}},t)},ne=function(){return u.a.createElement(h["a"],{allowClear:!1,options:c,onChange:Y("field"),value:d.split("."),changeOnSelect:!0,style:{width:"100%"},displayRender:function(e){return e.join(".")}})};return u.a.createElement("div",{className:E.a.conditionItemWrap},u.a.createElement(s["a"],{gutter:{xs:4,sm:8,md:12,lg:16},type:"flex",justify:"start",align:"top",className:"".concat(E.a.conditionItem)},u.a.createElement(p["a"],{span:5,className:"item-style"},u.a.createElement(k,null,ne())),u.a.createElement(p["a"],{span:5,className:"item-style"},u.a.createElement(k,null,u.a.createElement(b["a"],{defaultValue:q,onChange:Y("operator"),value:q,style:{width:"100%"}},I.operators.map((function(e){return u.a.createElement(C,{key:e},e)}))))),u.a.createElement(p["a"],{span:9},u.a.createElement("div",{style:{display:"flex",alignItems:"flex-start"},className:"item-style"},u.a.createElement(k,{style:{width:"36%",marginRight:2}},u.a.createElement(b["a"],{value:D,onChange:Z,className:"select-type"},V.map((function(e){var t=e.key,a=e.text;return u.a.createElement(C,{key:t},a)})))),u.a.createElement(k,{className:"item-style",validateStatus:te(ee),extra:ae(ee,"\u503c\u4e0d\u80fd\u4e3a\u7a7a")},u.a.createElement(F,Object(f["a"])({className:"select-value select-input-value",onChange:Y("value"),style:$,value:L},I.widgetProps,X))))),u.a.createElement(p["a"],{span:2},u.a.createElement(r["a"],{onClick:function(){return n(N,w)},type:"close",style:{fontSize:"20px",backgroundColor:"#eaeaea",verticalAlign:"middle",margin:"auto",padding:7,borderRadius:"50%"}}))))},D=function(e){return u.a.createElement(j["b"].Consumer,null,(function(t){return u.a.createElement(N,Object(f["a"])({},e,{context:t}))}))},I=D,A=a("Id/g"),_=a.n(A),T=function e(t){var a=t.dataRef,l=t.handleChangeCondition,c=t.handleDeleteCondition,o=t.handleAddCondition,s=t.handleAddGroup,f=t.handleDeleteGroup,p=t.columns,v=t.handleChangeRule,m=t.cascaderOptions,h=function(e,t){var a=[{value:1,text:"AND"},{value:0,text:"OR"}],n=a.find((function(t){return t.text===e})),r=n.value;return u.a.createElement(d,{buttons:a,onButtonClick:function(e){return l(t,e)},value:r})},y=function(e){var t=u.a.createElement(i["a"],null,u.a.createElement(i["a"].Item,{onClick:function(){return s(e)}},"Add Group"),u.a.createElement(i["a"].Item,{onClick:function(){return o(e)}},"Add Condition"));return u.a.createElement(n["a"],{overlay:t},u.a.createElement("div",{style:{width:35,marginLeft:10}},u.a.createElement(r["a"],{type:"plus",style:{fontSize:"20px",backgroundColor:"#eaeaea",verticalAlign:"middle",margin:"auto",padding:7,borderRadius:"50%"}})))},b=function(e){return u.a.createElement("div",{style:{width:35,marginLeft:10}},u.a.createElement(r["a"],{onClick:function(){return f(e)},type:"close",style:{fontSize:"20px",verticalAlign:"middle",backgroundColor:"#eaeaea",margin:"auto",padding:7,borderRadius:"50%"}}))},g=a.condition,j=a.rules,O=a.id,E=a.parent;return u.a.createElement("div",{className:_.a.groupContainer},u.a.createElement("div",{style:{display:"flex",justifyContent:"left",alignItems:"center",width:300}},h(g,O),y(O),E&&b(O)),u.a.createElement("div",{style:{paddingLeft:0,minWidth:600,position:"relative",left:16}},j.map((function(t){return t.rules?u.a.createElement(e,{key:t.id,dataRef:t,handleChangeCondition:l,handleDeleteCondition:c,handleAddCondition:o,handleAddGroup:s,handleDeleteGroup:f,columns:p,handleChangeRule:v,cascaderOptions:m}):u.a.createElement(I,{key:"r".concat(t.id),columns:p,rule:t,handleDeleteCondition:c,handleChangeRule:v,cascaderOptions:m})}))))};t["a"]=u.a.memo(T)},T9E4:function(e,t,a){"use strict";(function(e){a("e+1C");var n=a("Nd5c"),r=(a("ER8q"),a("Ai5L")),i=a("k1fw"),l=a("oBTY"),u=a("fWQN"),c=a("mtLc"),o=a("yKVA"),d=a("879j"),s=a("q1tI"),f=a.n(s),p=a("LvDl"),v=a("Wwog"),m=a("O9Rr"),h=a("33sl"),y=5,b=10,g=function e(t){return t.map((function(t){var a=t.field,n=t.label,r=t.children,i={value:a,label:n};return r&&r.length&&(i.children=e(r)),i}))},j=Object(v["a"])(g),O=Object(v["a"])(h["a"]),E=function(t){Object(o["a"])(s,t);var a=Object(d["a"])(s);function s(t){var n;return Object(u["a"])(this,s),n=a.call(this,t),n.triggerChange=function(){var e=n.props.onChange;e&&e(n.preview())},n.preprocessor=function(e){e.forEach((function(e){e.rules&&e.rules.length&&e.rules.forEach((function(t){var a=t;a.gid=e.id}))}))},n.getTree=function(t){t=e.cloneDeep(t),n.preprocessor(t);var a=t.reduce((function(e,t){return e[t.id]=t,e}),{}),r=[];return t.forEach((function(e){if(e.parent){var t=a[e.parent];t.rules?t.rules.push(e):t.rules=[e]}else r.push(e)})),r},n.onDeleteGroup=function(e){n.setState((function(t){var a=t.data,r=n.getTree(a),u=function t(a){var n=a.find((function(t){return t.rules&&t.id===e}));return n||t(a.filter((function(e){return e.rules})).reduce((function(e,t){return e.concat.apply(e,Object(l["a"])(t.rules))}),[]))},c=function(e){var t=[e.id],a=function e(a){a.forEach((function(a){a.rules&&(t.push(a.id),e(a.rules))}))};return a(e.rules),t},o=c(u(r));return a=a.filter((function(e){return!o.includes(e.id)})),Object(i["a"])(Object(i["a"])({},t),{},{data:a,groupCount:a.length})}),n.triggerChange)},n.createId=function(){return(new Date).valueOf().toString(36)},n.onAddGroup=function(e){n.setState((function(t,a){var r=a.columns;r=O(r);var l=t.data,u=t.groupCount;if(!(u>=y)){var c={id:n.createId(),parent:e,condition:"AND",rules:[]},o=n.createEmptyRule(r);return c.rules.push(o),l=l.concat(c),Object(i["a"])(Object(i["a"])({},t),{},{data:l,groupCount:u+1})}}),n.triggerChange)},n.createEmptyRule=function(e){var t=e[0],a=t.field,r=t.operators,i=t.defaultValue;return{id:n.createId(),field:a,operator:r[0],value:i,type:"constant"}},n.onAddCondition=function(e){n.setState((function(t,a){var r=a.columns;r=O(r);var l=t.data,u=l.find((function(t){return t.id===e}));if(!(u.rules.length>b)){var c=n.createEmptyRule(r);return u.rules.push(c),Object(i["a"])(Object(i["a"])({},t),{},{data:l})}}),n.triggerChange)},n.onChangeCondition=function(e){n.setState((function(t){var a=t.data,n=a.find((function(t){return t.id===e}));return n.condition="AND"===n.condition?"OR":"AND",Object(i["a"])(Object(i["a"])({},t),{},{data:a})}),n.triggerChange)},n.onChangeRule=function(e){n.setState((function(t){var a=t.data,n=e.id,r=e.gid,l=e.field,u=e.value,c=e.type,o=a.find((function(e){return e.id===r})),d=o.rules.findIndex((function(e){return e.id===n}));return o.rules[d]=Object(i["a"])(Object(i["a"])({},e),{},{field:l,value:u,type:c}),Object(i["a"])(Object(i["a"])({},t),{},{data:a})}),n.triggerChange)},n.onDeleteCondition=function(e,t){n.setState((function(a){var n=a.data,r=n.find((function(t){return t.id===e}));return r.rules=r.rules.filter((function(e){return e.id!==t})),Object(i["a"])(Object(i["a"])({},a),{},{data:n})}),n.triggerChange)},n.renderGroups=function(e){var t=n.props.columns;t=O(t);var a=j(t);return f.a.createElement(m["a"],{columns:t,dataRef:e,handleChangeCondition:n.onChangeCondition,handleDeleteCondition:n.onDeleteCondition,handleAddCondition:n.onAddCondition,handleAddGroup:n.onAddGroup,handleDeleteGroup:n.onDeleteGroup,handleChangeRule:n.onChangeRule,cascaderOptions:a})},n.getColumn=function(e,t){var a=t.find((function(t){return t.field===e.split(".")[0]}));return e.includes(".")?n.getColumn(e.split(".").slice(1).join("."),a.children):a},n.preview=function(){var t=n.state.data,a=n.props.columns;a=O(a),t=JSON.parse(JSON.stringify(t)),t=t.map((function(e){var t=e.rules.map((function(e){var t=n.getColumn(e.field,a);if("function"===typeof t.valueParser){var r,l=e.value||t.defaultValue;try{return r=t.valueParser(l),Object(i["a"])(Object(i["a"])({},e),{},{value:r})}catch(u){console.log("".concat(t.field," parser\u51fd\u6570\u8c03\u7528\u5931\u8d25 ").concat(u))}}return Object(i["a"])({value:t.defaultValue},e)}));return Object(i["a"])(Object(i["a"])({},e),{},{rules:t})}));var r=n.getTree(t),l=function t(a){return a.map((function(a){var n={};return a.rules?(n.operator=a.condition,n.children=t(a.rules)):n=e.pick(a,["value","field","operator","type"]),n}))};return l(r)[0]},n.state={data:t.data?t.data:[],groupCount:t.data?t.data.length:1},n}return Object(c["a"])(s,[{key:"render",value:function(){var t=this.state.data,a=this.props.columns;if(!t||e.isEmpty(t)||e.isEmpty(a))return null;var i=this.getTree(t),l={sm:{span:24},md:{span:24},lg:{span:24},xl:{span:18},xll:{span:18}};return f.a.createElement("div",null,f.a.createElement(n["a"],null,f.a.createElement(r["a"],l,this.renderGroups(i[0]))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return Object(p["isEmpty"])(t.data[0].rules)&&e.data!==t.data?Object(i["a"])(Object(i["a"])({},t),{},{data:e.data,groupCount:e.data.length}):null}}]),s}(s["Component"]);t["a"]=E}).call(this,a("LvDl"))},WiEq:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));var n={list:["parameter","ordering","displayfield","filter","paging","size"],retrieve:["displayfield","pk"],create:["parameter","displayfield","setfield"],update:["parameter","displayfield","setfield","pk"],replace:["parameter","displayfield","setfield","pk"],delete:["pk"],update_by_condition:["parameter","setfield","filter"],delete_by_condition:["parameter","filter"],func:["parameter","displayfield","setfield","func_name"],default:["slug","operation","summary","disable","logined","name","groups"]},r=[{label:"today",value:"today",isLeaf:!0,type:"date"},{label:"now",value:"now",isLeaf:!0,type:"datetime"},{label:"user",value:"user",isLeaf:!0,type:"ref"}]},Z8En:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("4X2C");var n=a("xvon"),r=(a("vc6j"),a("Q9CN")),i=a("0Owb"),l=(a("6dnR"),a("CQJL")),u=a("q1tI"),c=a.n(u),o=function(e){var t=e.value,a=void 0!==t&&t,n=e.onChange,r=e.type,i=e.onBlur,u={true:!0,false:!1},o="min"===r?{marginRight:0}:{};return c.a.createElement(l["a"].Group,{onChange:function(e){n(e.target.value),i&&i()},value:a},c.a.createElement(l["a"],{value:u.true,style:o},"true"),c.a.createElement(l["a"],{value:u.false,style:o},"false"))};function d(e){var t=e.componenttype,a=e.widgetonchange,l=e.value,u=e.style,d=e.className,s=e.widgetProps;return"int"===t||"integer"===t?c.a.createElement(r["a"],Object(i["a"])({value:l,style:u,className:d,type:"number",onChange:a},s)):"decimal"===t?c.a.createElement(r["a"],Object(i["a"])({type:"number",style:u,className:d,tep:.1,value:l,onChange:a},s)):"boolean"===t||"bool"===t?c.a.createElement(o,Object(i["a"])({value:l,onChange:a},s)):c.a.createElement(n["a"],Object(i["a"])({placeholder:"\u8bf7\u8f93\u5165",style:u,className:d,onChange:function(e){a(e.target.value)}},s,{value:l}))}t["b"]=d},fC8i:function(e,t,a){},hjOt:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return u}));var n=a("k1fw"),r=a("Wwog"),i=a("jfUH"),l=Object(r["a"])((function(e,t,a){var r=[],l=e[t].fields;return a&&(l=l.filter(a)),l.forEach((function(e){var t=Object(n["a"])({},e);if(t.key="".concat(e.name),t.label="".concat(t.key,"(").concat(e.displayName,")"),t.isLeaf=!0,t.type=e.type,Object(i["B"])(e)&&(t.isLeaf=!1,t.ref=e.ref),r.push(t),Object(i["D"])(e)){var a=Object(n["a"])({},t);a.key="".concat(e.name,"_id"),a.label="".concat(t.name,"(\u4e0a\u7ea7\u4e3b\u952eid)"),a.isLeaf=!0,r.push(a),a.type="integer"}})),r})),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parent,a=e.nameType,r=e.dollarData,l=function e(t,a){return a.map((function(a){var r=Object(n["a"])(Object(n["a"])({},a.value),{},{label:a.value.name,value:a.value.name}),i=t.filter((function(e){return e.pid===a.id})),l=t.filter((function(e){return e.id!==a.id||e.pid!==a.id}));return i.length>0&&(r.children=e(l,i)),r}))},u=[];Object.keys(r).forEach((function(e){var t=r[e].value.name;t&&u.push(r[e])}));var c=u;Object(i["C"])(a)&&(c=u.filter((function(e){var t=e.value.type;return"object"===t}))),"bref"===a&&(c=u.filter((function(e){var t=e.value.type;return"array"===t})));var o=l(c.filter((function(e){return-1!==e.pid})),c.filter((function(e){return-1===e.pid})));if(t){var d=[],s=function e(a){return a.forEach((function(a){a.value===t&&a.children?d=a.children:a.children&&e(a.children)}))};return s(o),d}return o}},i2l7:function(e,t,a){"use strict";(function(e){a("A1Tt");var n=a("QYOG"),r=a("oBTY"),i=a("k1fw"),l=a("0Owb"),u=a("PpiC"),c=(a("t6ct"),a("BGsl")),o=a("q1tI"),d=a.n(o),s=c["a"].TreeNode,f=function(e,t){return-1!==e.indexOf(t)},p=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.map((function(t){var n=t.children,r=Object(u["a"])(t,["children"]);return d.a.createElement(s,Object(l["a"])({},r,{disabled:a.includes(r.key),key:r.key,dataRef:t}),e(n,a))}))},v=function(t){var a=t.dataSource,o=t.targetKeys,s=t.onLoadData,v=Object(u["a"])(t,["dataSource","targetKeys","onLoadData"]),m=[],h={};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){m.push(e),h[e.key]=e,y(e.children)}))}y(a);var b=function(t){var a={};function n(e){if(e.pKey&&!(e.pKey in a)){var t=Object(i["a"])({},h[e.pKey]);a[e.pKey]=t,n(t)}}t.forEach((function(t){a[t.key]=e.omit(Object(i["a"])({},t),["children"])})),t.forEach((function(e){n(e)}));var l=e.values(a),u=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=Object(r["a"])(a.map((function(e){return Object(i["a"])({},e)})));return n.map((function(a){var n=Object(i["a"])({},a),r=t.filter((function(e){return e.pKey===a.key})),l=t.filter((function(e){return e.key!==a.key||e.pKey!==a.key}));return r.length>0&&(n.showAdd=!0,n.children=e(l,r)),n}))};return u(l.filter((function(e){return!!e.pKey})),l.filter((function(e){return!e.pKey})))};return d.a.createElement(n["a"],Object(l["a"])({},v,{targetKeys:o,dataSource:m,className:"tree-transfer",render:function(e){return e.title},showSelectAll:!1,titles:["\u53ef\u7528\u5b57\u6bb5","\u8fd4\u56de\u5b57\u6bb5"],operations:["\u52a0\u5165\u53f3\u4fa7","\u52a0\u5165\u5de6\u4fa7"]}),(function(e){var t=e.direction,n=e.onItemSelect,i=e.selectedKeys,l=e.filteredItems;if("left"===t){var u=[].concat(Object(r["a"])(i),Object(r["a"])(o));return d.a.createElement(c["a"],{blockNode:!0,checkable:!0,checkedKeys:u,loadData:s,onCheck:function(e,t){var a=t.node.props.eventKey;n(a,!f(u,a))},onSelect:function(e,t){var a=t.node.props.eventKey;n(a,!f(u,a))}},p(a,o))}if("right"===t){var v=Object(r["a"])(i),m=b(l);return d.a.createElement(c["a"],{blockNode:!0,checkable:!0,defaultExpandAll:!0,defaultExpandParent:!0,checkedKeys:v,onCheck:function(e,t){var a=t.node.props.eventKey;n(a,!f(v,a))},onSelect:function(e,t){var a=t.node.props.eventKey;n(a,!f(v,a))}},p(m,[]))}return null}))};t["a"]=v}).call(this,a("LvDl"))},o0Ez:function(e,t,a){},q9L5:function(e,t,a){"use strict";(function(e){var n=a("tJVT"),r=a("q1tI"),i=a.n(r),l=a("jfUH"),u=a("i2l7");function c(t){var a=t.schemas,c=t.model,o=t.onChange,d=t.value,s=void 0===d?[]:d,f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;function n(r,i,u){if(u>=t)return[];var c=a[r]||{},o=c.fields,d=void 0===o?[]:o;return d.map((function(t){var a={pKey:i};return a.key="".concat(i?"".concat(i,"."):"").concat(t.name),a.title="".concat(t.displayName,"(").concat(t.name,")"),a.isLeaf=!0,a.type=t.type,Object(l["B"])(t)&&(a.children=n(t.ref,a.key,u+1),e.isEmpty(a.children)||(a.isLeaf=!1),a.ref=t.ref),a}))}return n(c,"",0)},p=Object(r["useState"])([]),v=Object(n["a"])(p,2),m=v[0],h=v[1],y=Object(r["useState"])(f(3)),b=Object(n["a"])(y,2),g=b[0],j=b[1],O=function(e){h(e),o&&o(e)};return Object(r["useEffect"])((function(){j(f(3))}),[c]),Object(r["useEffect"])((function(){s!==m&&O(s)}),[s]),i.a.createElement("div",null,i.a.createElement("div",{style:{paddingBottom:15}},i.a.createElement("span",{style:{fontSize:26}},"\u8fd4\u56de\u5b57\u6bb5")),i.a.createElement("div",{style:{padding:30,paddingTop:0,maxHeight:400}},g.length>0&&i.a.createElement(u["a"],{dataSource:g,targetKeys:m,onChange:O,listStyle:{width:250,maxHeight:400,overflow:"scroll"}})))}t["a"]=c}).call(this,a("LvDl"))},v9ey:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s}));var n=a("9og8"),r=a("WmNS"),i=a.n(r),l=a("mmaM");function u(){return c.apply(this,arguments)}function c(){return c=Object(n["a"])(i.a.mark((function e(){var t,a,n,r=arguments;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},a=r.length>1?r[1]:void 0,n="add_api",(0===a||a)&&(n="update_api"),e.abrupt("return",Object(l["request"])("/basebone/client/api_db__api/func/",{method:"POST",data:{func_name:n,params:{id:a,config:t}}}));case 5:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function o(e){return d.apply(this,arguments)}function d(){return d=Object(n["a"])(i.a.mark((function e(t){return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l["request"])("/basebone/client/api_db__api/func/",{method:"POST",data:{func_name:"show_api",params:{slug:t}}}));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function s(){return f.apply(this,arguments)}function f(){return f=Object(n["a"])(i.a.mark((function e(){return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l["request"])("/basebone/client/auth__group/list/",{method:"POST"}));case 1:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}},x7hw:function(e,t,a){e.exports={conditionItemWrap:"conditionItemWrap___NYL3t",conditionItem:"conditionItem___1gJLA"}},xr0V:function(e,t,a){}}]);