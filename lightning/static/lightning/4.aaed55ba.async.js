(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"+dfd":function(e,t,n){"use strict";(function(e){var a,l,r=n("jrin"),c=(n("4csm"),n("2Fwu")),i=(n("eE3J"),n("GSZB")),u=(n("9kbU"),n("vbHR")),o=n("k1fw"),f=(n("SePM"),n("PMX6")),m=(n("Ahcs"),n("k0dM")),s=(n("Dvpn"),n("myml")),d=(n("eNCU"),n("pjJH")),v=(n("QjdF"),n("U4Vl")),p=(n("6dnR"),n("CQJL")),b=(n("yavW"),n("WuMn")),h=(n("4X2C"),n("xvon")),E=(n("vmZS"),n("NjVP")),y=n("oBTY"),g=n("tJVT"),O=n("q1tI"),j=n.n(O),C=n("RsOY"),S=n.n(C),w=n("rfrl"),k=n("jfUH"),N=n("O/S9"),F=n("mmaM"),D=n("umGZ"),I=n("5jOq"),P=n.n(I),V=n("VW+w"),x=n("cPjh"),L=n("HrPU"),A=n("MxUj"),T=n("wiuW"),M=n("poQN"),G={group:"\u5206\u7ec4"};function J(t){return t&&(null===t||void 0===t?void 0:t.map((function(t){return e.isString(t)?{name:t}:t})))}function B(t){var n,a=t.modelName,l=t.detailValue,r=t.schemas,c=t.useLayout,i=void 0!==c&&c,u=t.style,o=void 0===u?"group":u,f=t.bsmSetting.staff_model,m=[],C=[];l&&(m=null!==(n=(e.cloneDeep(l.sections)||[]).map((function(e){var t=e;return t.fields=J(t.fields),t})))&&void 0!==n?n:[],C=J(e.cloneDeep(l.fields))||m.filter((function(t){return!e.isEmpty(t.fields)})).reduce((function(e,t){return e.concat(t.fields)}),[]));var S=Object(O["useState"])(m),I=Object(g["a"])(S,2),x=I[0],A=I[1],T=Object(O["useState"])(C),M=Object(g["a"])(T,2),B=M[0],U=M[1],q=Object(O["useState"])([]),K=Object(g["a"])(q,2),W=K[0],$=K[1];function R(t,n){var a=e.cloneDeep(x);a[t].title=n,A(a)}function H(t,n){var a=e.cloneDeep(x);a[t].fields=n.map((function(e){return B.find((function(t){return t.name===e}))})),A(a)}function X(t,n){var a=e.cloneDeep(x);a[t].style||(a[t].style={}),a[t].style.widget=n,A(a)}function Z(){A(m),U(C)}function Q(t){var n=e.cloneDeep(x);n.splice(t,1),A(n)}function Y(){U([].concat(Object(y["a"])(B),[{}]))}function _(e){return{name:e}}function z(t){var n=e.cloneDeep(B);n.splice(t,1);var a=(e.cloneDeep(x)||[]).map((function(e){var t,a=e;a.fields&&(a.fields=null===(t=a.fields)||void 0===t?void 0:t.filter((function(e){return n.map((function(e){return e.name})).includes(e.name)})));return a}));A(a),U(n)}function ee(t,n,a){var l=e.cloneDeep(B);l[t][a]=n,U(l)}function te(t){var n=e.cloneDeep(x),a=t-1,l=[n[t],n[a]];n[a]=l[0],n[t]=l[1],A(n)}function ne(t){var n=e.cloneDeep(x),a=t+1,l=[n[t],n[a]];n[a]=l[0],n[t]=l[1],A(n)}Object(O["useEffect"])((function(){var t,n,l=[],c=[];if(f){var i=[];r[a].fields.forEach((function(e){e.ref===f&&i.push(e)})),$(i)}var u=null===(t=e.cloneDeep(B))||void 0===t?void 0:t.filter((function(e){return Object(k["t"])(a,e.name)}));u.forEach((function(t,n){var r=t;r.showIf&&r.showIf.forEach((function(t,r){var i=t;if(e.isArray(i.value)){var u=Object(k["t"])(a,i.field),o=new Promise((function(e){Object(F["queryContent"])({model:u.ref,filters:[{field:Object(k["L"])(u.ref),operator:"in",value:i.value}]}).then((function(t){var a=t.list;l.push([n,r,a]),e()}))}));c.push(o)}}))}));var o=null===(n=e.cloneDeep(x))||void 0===n?void 0:n.map((function(e){var t=e;return t.fields&&(t.fields=t.fields.filter((function(e){return u.map((function(e){return e.name})).includes(e.name)}))),t}));Promise.all(c).then((function(){l.forEach((function(e){var t=Object(g["a"])(e,3),n=t[0],a=t[1],l=t[2];u[n].showIf[a].value=l}))})),U(u),A(o)}),[]);var ae=function(e,t){U(Object(w["a"])(B,(function(n){t?n[e].alias=t:delete n[e].alias})))},le={handleDisPlayName:ae,handleFieldChange:ee,deleteField:z,addField:Y,reset:Z,setFields:U,getField:_};function re(t){var n,c;if(void 0===t)return null;var i=B[t];return j.a.createElement(E["a"],{labelCol:{span:5},wrapperCol:{span:19}},j.a.createElement(E["a"].Item,{label:"\u5b57\u6bb5"},j.a.createElement(L["a"],{value:i.name,onChange:function(e){return ee(t,e,"name")},model:a,allowClear:!1})),j.a.createElement(E["a"].Item,{label:"\u663e\u793a\u540d"},j.a.createElement(h["a"],{allowClear:!0,value:i.alias,onChange:function(e){return ae(t,e.target.value)},placeholder:i.name&&Object(V["displayPreprocess"])([e.cloneDeep(i)],a,r)[0].alias})),j.a.createElement("div",{className:P.a.divider,style:{marginBottom:16}},"\u6743\u9650\u8bbe\u7f6e"),j.a.createElement(D["a"],{groupsValue:null!==(n=null===(c=i.groups)||void 0===c?void 0:c.filter((function(e){return!("number"===typeof e)})))&&void 0!==n?n:[],groupsOnChange:function(n){var a=e.cloneDeep(B);a[t].groups=n,U(Object(y["a"])(a))},userValue:i.userField,userOnChange:function(n){var a=e.cloneDeep(B);a[t].userField=n,U(Object(y["a"])(a))},staffModelFields:W,staffModel:f,defauldGroupValue:l.fields[t]}),j.a.createElement(E["a"].Item,{label:"\u6ee1\u8db3\u6761\u4ef6\u663e\u793a"},j.a.createElement(N["a"],{fields:r[a].fields,context:{model:a},onChange:function(e){return ee(t,e,"showIf")},value:i.showIf,disabledField:function(e){return i.showIf.filter((function(e){return e.field})).map((function(e){return e.field})).includes(e.name)}})))}var ce=i&&j.a.createElement(E["a"],{layout:"inline"},"default"!==o&&j.a.createElement(j.a.Fragment,null,j.a.createElement(s["a"],{style:{marginTop:24},size:"middle",bordered:!0,dataSource:x,pagination:!1,columns:[{title:"".concat(G[o],"\u540d\u79f0"),key:"title",render:function(e,t,n){return j.a.createElement(h["a"],{value:e.title,onChange:function(e){return R(n,e.target.value)}})}},{title:"\u6240\u542b\u5b57\u6bb5",key:"fields",render:function(e,t,n){var l;return j.a.createElement(b["a"],{mode:"multiple",value:null===(l=e.fields)||void 0===l?void 0:l.map((function(e){return e.name})),onChange:function(e){H(n,e)}},B.filter((function(e){return e.name})).map((function(t){var n;return j.a.createElement(b["a"].Option,{value:t.name,key:t.name,disabled:x.map((function(e){var t;return null===(t=e.fields)||void 0===t?void 0:t.map((function(e){return e.name}))})).flat().includes(t.name)&&!(e.fields||[]).map((function(e){return e.name})).includes(t.name)},null===(n=r[a].fields.find((function(e){return e.name===t.name})))||void 0===n?void 0:n.displayName)})))}},{title:"\u663e\u793a\u98ce\u683c",key:"style.widget",render:function(e,t,n){return j.a.createElement(p["a"].Group,{value:e.style&&e.style.widget||"cell",onChange:function(e){return X(n,e.target.value)}},j.a.createElement(p["a"],{value:"cell"},"\u5217\u8868"),j.a.createElement(p["a"],{value:"table"},"\u8868\u683c"))}},{title:"\u64cd\u4f5c",key:"option",render:function(e,t,n){return j.a.createElement(j.a.Fragment,null,j.a.createElement("a",{onClick:function(){return Q(n)}},"\u5220\u9664"),n>0&&j.a.createElement(j.a.Fragment,null,j.a.createElement(v["a"],{type:"vertical"}),j.a.createElement("a",{onClick:function(){return te(n)}},"\u4e0a\u79fb")),n<x.length-1&&j.a.createElement(j.a.Fragment,null,j.a.createElement(v["a"],{type:"vertical"}),j.a.createElement("a",{onClick:function(){return ne(n)}},"\u4e0b\u79fb")))}}],footer:function(){return j.a.createElement(d["a"],{onClick:function(){return A([].concat(Object(y["a"])(x),[{}]))}},"\u6dfb\u52a0",G[o])}})));return[re,ce,B,x,le]}function U(t){var n=t.modelName,a=t.adminConfig,l=t.schemas,r=t.bsmSetting,c="default";a[n].detail&&(c=a[n].detail.style||c);var i=Object(O["useState"])(c),u=Object(g["a"])(i,2),o=u[0],s=u[1],d=Object(O["useState"])(String(0)),b=Object(g["a"])(d,2),h=b[0],y=b[1],C=B({modelName:n,adminConfig:a,schemas:l,useLayout:!0,style:o,bsmSetting:r}),S=Object(g["a"])(C,5),w=S[0],k=S[1],N=S[2],F=S[3],D=S[4],I=D.deleteField,P=D.addField,V=D.check,x=D.detailReset;function L(){x(),s(c)}function A(){P(),y(String(N.length))}var T={style:o,sections:"default"!==o&&F,fields:"default"===o&&N},M=j.a.createElement(m["a"],{tabBarStyle:{minWidth:48},activeKey:h,tabPosition:"left",type:"editable-card",onChange:y,onEdit:function(e,t){var n={add:A,remove:function(){return I(e)}};n[t]()}},N.map((function(e,t){var a=l[n].fields.find((function(t){return t.name===e.name}));return j.a.createElement(m["a"].TabPane,{tab:(a||{}).displayName||"\u5b57\u6bb5".concat(t+1),key:t,closable:!a||!a.required||N.filter((function(t){return t.name===e.name})).length>=2},w(t))}))),J=j.a.createElement(j.a.Fragment,null,j.a.createElement(f["a"],{title:"\u8be6\u60c5\u5b57\u6bb5",type:"inner"},M),j.a.createElement(v["a"],null),j.a.createElement(E["a"],{layout:"inline"},j.a.createElement(E["a"].Item,{label:"\u6392\u5217\u65b9\u5f0f"},j.a.createElement(p["a"].Group,{value:o,onChange:function(e){return s(e.target.value)}},j.a.createElement(p["a"],{value:"default"},"\u9ed8\u8ba4"),e.map(G,(function(e,t){return j.a.createElement(p["a"],{value:t},e)}))))));return[J,k,T,L,V]}function q(t){var n,a,r=t.schemas,f=t.modelName,m=t.detailValue,s=t.bsmSetting,v=t.onChange,p=[],E=[],C=[];"default"===(null===m||void 0===m?void 0:m.style)||e.isEmpty(null===m||void 0===m?void 0:m.sections)?p=[(null===m||void 0===m||null===(n=m.fields)||void 0===n?void 0:n.length)||0]:null===m||void 0===m||null===(a=m.sections)||void 0===a||a.forEach((function(e){e.fields&&p.push(e.fields.length),E.push(e.title),C.push(e.style)}));var w=Object(O["useState"])(p),N=Object(g["a"])(w,2),F=N[0],D=N[1],I=Object(O["useState"])(E),P=Object(g["a"])(I,2),V=P[0],A=P[1],J=Object(O["useState"])(C),U=Object(g["a"])(J,2),q=U[0],K=U[1],W="group",$=B({modelName:f,detailValue:m,schemas:r,style:W,bsmSetting:s}),R=Object(g["a"])($,5),H=R[0],X=R[2],Z=R[4],Q=Z.deleteField,Y=Z.setFields,_=Z.getField,z=Z.handleFieldChange;function ee(e){var t=0,n=e.length+F[l];F.forEach((function(e,n){n<=l&&(t+=e)}));var a=e.map(_),r=S()(X,{$splice:[[t,0].concat(Object(y["a"])(a))]});Y(r),D(S()(F,{$splice:[[l,1,n]]}))}var te=Object(x["d"])({modelName:f,schemas:r,onOk:function(){return ee(le)},fieldDisabled:function(e){return X.map((function(e){return e.name})).includes(e.name)},expand:!0}),ne=Object(g["a"])(te,3),ae=ne[0],le=ne[1],re=ne[2];function ce(e,t){Q(Object(x["c"])(e,t,F)),D(S()(F,{$splice:[[t,1,F[t]-1]]}))}function ie(e){var t=F.reduce((function(t,n,a){return a<e?t+n:t}),0);Y(S()(X,{$splice:[[t,F[e]]]})),D(S()(F,{$splice:[[e,1]]})),A(S()(V,{$splice:[[e,1]]})),K(S()(q,{$splice:[[e,1]]}))}function ue(e,t,n){z(Object(x["c"])(e,t,F),n,"name")}function oe(e,t){A(S()(V,{$splice:[[e,1,t]]}))}function fe(t,n){if(n in T["c"]){var a=F.reduce((function(e,n,a){return a<t?e+n:e}),0),l=e.cloneDeep(F);l[t]=0,Y(S()(X,{$splice:[[a,F[t]]]})),D(l)}K(S()(q,{$splice:[[t,1,{widget:n}]]}))}function me(t,n){var a=e.cloneDeep(F);a.splice(t,0,0),D(a);var l=e.cloneDeep(q);l.splice(t,0,{widget:n}),K(l),A(S()(V,{$splice:[[t,0,null]]}))}var se=Object(k["cb"])(f),de=Object(o["a"])(Object(o["a"])({},m),{},{style:W,fields:"default"===W&&X});if(Object(O["useEffect"])((function(){v(de)}),[F,V,q,W,X]),"default"!==W){var ve=0;de.sections=[],F.forEach((function(e,t){de.sections.push({title:V[t],fields:X.slice(ve,ve+e),style:q[t]}),ve+=e}))}var pe=j.a.createElement(x["b"],{sectionStyle:q,style:W,sections:F,sectionTitles:V,setSections:D,bordered:!1,allData:X,setData:Y,modalView:ae,columns:[{title:"\u663e\u793a\u540d\u79f0",key:"alias",render:function(e){var t;return null!==(t=e.alias)&&void 0!==t?t:se(e.name)}},{title:"\u5b57\u6bb5",key:"name",render:function(e,t,n,a){return j.a.createElement(L["a"],{value:e.name,onChange:function(e){return ue(n,a,e)},model:f},j.a.createElement(M["a"],{fieldPath:e.name,modelName:f}))}},{title:"\u64cd\u4f5c",key:"operation",render:function(e,t,n,a){return j.a.createElement(j.a.Fragment,null,j.a.createElement("a",{onClick:function(){return ce(n,a)}},"\u5220\u9664"))}}],footer:function(e){return j.a.createElement(d["a"],{onClick:function(){l=e,re()}},"\u6dfb\u52a0\u5b57\u6bb5")},expandedRowRender:function(e,t,n,a,l){return H(Object(x["c"])(t,l,F))},addAndDeleteView:function(e){var t;return"default"!==W&&j.a.createElement("div",null,"\u5361\u7247\u7c7b\u578b\uff1a",j.a.createElement(b["a"],{value:(null===(t=q[e])||void 0===t?void 0:t.widget)||"cell",onChange:function(t){return fe(e,t)},style:{minWidth:120,maxWidth:200}},j.a.createElement(b["a"].Option,{value:"cell"},"\u5b57\u6bb5\u5217\u8868"),j.a.createElement(b["a"].Option,{value:"tiles"},"\u5b57\u6bb5\u5e73\u94fa"),j.a.createElement(b["a"].Option,{value:"table"},"\u5b57\u6bb5\u8868\u683c"),j.a.createElement(b["a"].Option,{value:"table-v"},"\u5782\u76f4\u5b57\u6bb5\u8868\u683c"),Object.keys(T["e"]).map((function(e){return T["e"][e].includes(f)&&j.a.createElement(b["a"].Option,{value:e},T["d"][e])}))),0!==e&&j.a.createElement(d["a"],{icon:"delete",onClick:function(){return ie(e)}},"\u5220\u9664"))},addAndWidget:function(e){return"default"!==W&&j.a.createElement("div",null,j.a.createElement(c["a"],{overlay:j.a.createElement(u["a"],{onClick:function(t){return me(e+1,t.key)}},j.a.createElement(u["a"].Item,{key:"cell"},"\u5b57\u6bb5\u5217\u8868"),j.a.createElement(u["a"].Item,{key:"tiles"},"\u5b57\u6bb5\u5e73\u94fa"),j.a.createElement(u["a"].Item,{key:"table"},"\u5b57\u6bb5\u8868\u683c"),j.a.createElement(u["a"].Item,{key:"table-v"},"\u5782\u76f4\u5b57\u6bb5\u8868\u683c"),Object.keys(T["e"]).map((function(e){return T["e"][e].includes(f)&&j.a.createElement(u["a"].Item,{key:e},T["d"][e])}))),trigger:["click"]},j.a.createElement(d["a"],{type:"dashed",block:!0},j.a.createElement(i["a"],{type:"plus"}))))},tableTitle:function(e){return"default"!==W&&j.a.createElement("div",null,"".concat(G[W],"\u540d\u79f0"),"\xa0\xa0",j.a.createElement(h["a"],{style:{width:100},value:V[e],onChange:function(t){return oe(e,t.target.value)},placeholder:"\u7b2c".concat(e+1,"\u7ec4")}))}});return pe}var K=(a={},Object(r["a"])(a,A["b"],U),Object(r["a"])(a,A["c"],q),a);t["a"]=K[A["a"]]}).call(this,n("LvDl"))},D27F:function(e,t,n){"use strict";n("SePM");var a=n("PMX6"),l=(n("vmZS"),n("NjVP")),r=(n("6dnR"),n("CQJL")),c=n("tJVT"),i=n("q1tI"),u=n.n(i),o=n("OTll");function f(e){var t=e.modelName,n=e.schemas,f=e.adminConfig,m=e.bsmSetting,s=Object(o["a"])({modelName:t,schemas:n,adminConfig:f,bsmSetting:m}),d=Object(c["a"])(s,6),v=d[0],p=d[1],b=d[2],h=d[3],E=d[4],y=d[5],g=Object(i["useState"])(f[t].modalForm),O=Object(c["a"])(g,2),j=O[0],C=O[1],S={formFields:p,formLayout:y,modalForm:j};function w(){var e=E();return S.formFields=e,S}function k(){b()}function N(){return h()}var F=u.a.createElement(u.a.Fragment,null,v,u.a.createElement(a["a"],{title:"\u57fa\u672c\u8bbe\u7f6e",type:"inner"},u.a.createElement(l["a"],{layout:"inline"},u.a.createElement(l["a"].Item,{label:"\u8868\u5355\u754c\u9762"},u.a.createElement(r["a"].Group,{value:j,onChange:function(e){return C(e.target.value)}},u.a.createElement(r["a"],{value:!0},"\u5f39\u7a97\u7f16\u8f91"),u.a.createElement(r["a"],{value:!1},"\u65b0\u9875\u9762\u7f16\u8f91"))))));return[F,S,k,w,N]}t["a"]=f},LK96:function(e,t,n){"use strict";n("SePM");var a=n("PMX6"),l=(n("vmZS"),n("NjVP")),r=(n("6dnR"),n("CQJL")),c=n("tJVT"),i=n("q1tI"),u=n.n(i),o=n("Ol5k");function f(e){var t=e.modelName,n=e.schemas,f=e.adminConfig,m=e.bsmSetting,s=Object(o["a"])({modelName:t,schemas:n,adminConfig:f,bsmSetting:m}),d=Object(c["a"])(s,5),v=d[0],p=d[1],b=d[2],h=d[3],E=d[4],y=Object(i["useState"])(f[t].modalDetail),g=Object(c["a"])(y,2),O=g[0],j=g[1],C={detail:void 0,details:b,modalDetail:O},S=function(){var e=E();return C.details=e,C};function w(){h()}var k=u.a.createElement(u.a.Fragment,null,v,u.a.createElement(a["a"],{title:"\u57fa\u672c\u8bbe\u7f6e",type:"inner"},u.a.createElement(l["a"],{layout:"inline"},u.a.createElement(l["a"].Item,{label:"\u8be6\u60c5\u754c\u9762"},u.a.createElement(r["a"].Group,{value:!!O,onChange:function(e){return j(e.target.value)}},u.a.createElement(r["a"],{value:!0},"\u5f39\u7a97"),u.a.createElement(r["a"],{value:!1},"\u65b0\u9875\u9762"))))),p);return[k,C,w,S]}t["a"]=f},MxUj:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return r}));var a="v1",l="v2",r=l},OTll:function(e,t,n){"use strict";(function(e){var a,l,r=n("jrin"),c=(n("4X2C"),n("xvon")),i=(n("eE3J"),n("GSZB")),u=(n("eNCU"),n("pjJH")),o=(n("QjdF"),n("U4Vl")),f=(n("SePM"),n("PMX6")),m=(n("Ahcs"),n("k0dM")),s=(n("vc6j"),n("Q9CN")),d=(n("UvA9"),n("u4G2")),v=(n("vmZS"),n("NjVP")),p=n("k1fw"),b=n("oBTY"),h=n("tJVT"),E=(n("OaEy"),n("2fM7")),y=n("q1tI"),g=n.n(y),O=n("4b23"),j=n.n(O),C=n("RsOY"),S=n.n(C),w=n("9Ndd"),k=n("HrPU"),N=n("VW+w"),F=n("O/S9"),D=n("jfUH"),I=n("mmaM"),P=n("umGZ"),V=n("cPjh"),x=n("hzhw"),L=n("MxUj"),A=n("5jOq"),T=n.n(A),M=function(e){var t=e.value,n=e.onChange,a=e.model,l=e.disabledField,r=e.bordered,c=void 0===r||r,i=e.dropdownMatchSelectWidth,u=e.showSearch,o=void 0===u||u,f=Object(D["tb"])(a)||[];return g.a.createElement(E["a"],{bordered:c,showArrow:c,dropdownMatchSelectWidth:i,value:t,onChange:n,showSearch:o,filterOption:function(e,t){var n=t.props,a=n.value,l=n.children,r=e.toLowerCase();return a.replace(/_/g,"").toLowerCase().includes(r)||l.toLowerCase().includes(r)}},f.map((function(e){return g.a.createElement(E["a"].Option,{value:e.name,disabled:l&&l(e)},e.displayName)})))},G={group:"\u5206\u7ec4",tab:"\u6807\u7b7e",step:"\u5206\u6b65"};function J(t){var n=t.schemas,a=t.modelName,l=t.adminConfig,r=t.bsmSetting.staff_model,c=Object(y["useState"])(e.cloneDeep(l[a].formFields)),i=Object(h["a"])(c,2),u=i[0],o=i[1],f=Object(y["useState"])([]),m=Object(h["a"])(f,2),O=m[0],C=m[1],S=Object(y["useState"])(!1),V=Object(h["a"])(S,2),x=V[0],L=V[1],A=n[a].fields,G=Object(w["h"])(),J=Object(w["g"])(),B={},U=function(t,n){var a=[],l=[];t.forEach((function(t,n){var r=t;r.showIf&&(e.isArray(r.showIf)?r.showIf:[r.showIf]).forEach((function(t,r){if(e.isObject(t.value)){var c=A.find((function(e){return e.name===t.field})),i=new Promise((function(e){Object(I["queryContent"])({model:c.ref,filters:[{field:Object(D["L"])(c.ref),operator:"in",value:t.value}]}).then((function(t){var l=t.list;a.push([n,r,l]),e()}))}));l.push(i)}}))}));var r=t;e.isEmpty(l)?n&&n(r):Promise.all(l).then((function(){a.forEach((function(e){var t=Object(h["a"])(e,3),n=t[0],a=t[1],l=t[2];r[n].showIf[a].value=l})),o(r),n&&n(r)}))},q=function(t,n){var l=[],r=[];t.forEach((function(t,n){t.choicesFilter&&t.choicesFilter.forEach((function(c,i){if(e.isArray(c.value)){var u=Object(D["t"])(a,"".concat(t.name,".").concat(c.field));r.push(Object(I["queryContent"])({model:u.ref,filters:[{field:Object(D["L"])(u.ref),operator:"in",value:c.value}]}).then((function(e){var t=e.list;l.push([n,i,t])})))}}))}));var c=e.cloneDeep(t);e.isEmpty(r)?n&&n(c):Promise.all(r).then((function(){l.forEach((function(e){var t=Object(h["a"])(e,3),n=t[0],a=t[1],l=t[2];c[n].choicesFilter[a].value=l})),o(c),n&&n(c)}))};function K(){o(l[a].formFields)}function W(){return!0}function $(){o([].concat(Object(b["a"])(u),[{params:{}}]))}function R(e){return{name:e,params:{}}}function H(e){var t=e.map(R);o([].concat(Object(b["a"])(u),Object(b["a"])(t)))}function X(t){var n=e.cloneDeep(u);n.splice(t,1),o(n)}function Z(t,n){var a=e.cloneDeep(u);a[t]={name:n,params:{}},o(a)}function Q(t,n,a){var l=e.cloneDeep(u);l[t][a]=n,o(l)}function Y(t,n,a){var l=e.cloneDeep(u);l[t].params[n]=a,o(l)}function _(t,l){var r=e.cloneDeep(u);if(l){r[t].widget=l;var c=n[a].fields.find((function(e){return e.name===r[t].name}));if(["TreeSelect","Cascader"].includes(l)){var i=n[c.ref].fields.find((function(e){return Object(D["D"])(e)&&e.ref===c.ref}));i&&(r[t].params.parent=i.name)}if(["Gallery"].includes(l)){var f=n[c.ref].fields.find((function(e){return["string","text","image","file"].includes(e.type)}));f&&(r[t].params.urlField=f.name)}}else delete r[t].widget;o(r)}function z(){var t=e.cloneDeep(u).filter((function(e){return e.name})).map((function(t){var n=t;return n.showIf&&(n.showIf=n.showIf.filter((function(e){return e.field&&e.operator&&void 0!==e.value})).map((function(t){var n=Object(p["a"])({},t);if(e.isObject(n.value)){var a=A.find((function(e){return e.name===t.field}));e.isArray(n.value)&&(n.value=n.value.map((function(e){return Object(D["K"])(e,a.ref)})))}return n})),n.choicesFilter&&(n.choicesFilter=n.choicesFilter.filter((function(e){return e.field&&e.operator&&void 0!==e.value})).map((function(n){var l=Object(p["a"])({},n);if(e.isObject(l.value)){var r=Object(D["t"])(a,"".concat(t.name,".").concat(n.field));e.isArray(l.value)&&(l.value=l.value.map((function(e){return Object(D["K"])(e,r.ref)})))}return l})))),e.isEmpty(t.groups)||(n.groups=n.groups.filter((function(e){return e})).map((function(e){return e.id||e}))),t.id||(n.id=j()(6)),n}));return t}Object(y["useEffect"])((function(){if(r){var e=[];n[a].fields.forEach((function(t){t.ref===r&&e.push(t)})),C(e)}U(u,(function(e){return q(e,(function(){return L(!0)}))}))}),[]);var ee={handleAdd:$,handleDelete:X,setFormFields:o,changeFieldName:Z,addFields:H,getField:R};function te(t){var c,i;if(void 0===t)return null;var f=u[t];if(!f.name)return null;var m=A.find((function(e){return e.name===f.name})),p=f.name&&Object(N["formFieldsPreprocess"])([e.cloneDeep(f)],[e.cloneDeep(m)])[0].widget;return g.a.createElement(v["a"],{labelCol:{span:5},wrapperCol:{span:19}},g.a.createElement(v["a"].Item,{label:"\u5b57\u6bb5"},g.a.createElement(M,{value:f.name,onChange:function(e){return Z(t,e)},model:a,disabledField:function(e){return u.map((function(e){return e.name})).includes(e.name)&&e.name!==f.name}})),f.name&&g.a.createElement(v["a"].Item,{label:"\u7ec4\u4ef6"},g.a.createElement(E["a"],{value:f.widget||null,onChange:function(e){return _(t,e)}},g.a.createElement(E["a"].Option,{value:null},"\u9ed8\u8ba4\uff08",G[w["e"][m.type]]||w["e"][m.type],"\uff09"),e.uniq(J[m.type].concat(m.choices?["Select"]:[])).map((function(e){return g.a.createElement(E["a"].Option,{value:e,disabled:B[e]},G[e]||e)})))),["TreeSelect","Cascader"].includes(p)&&g.a.createElement(v["a"].Item,{label:"\u7236\u7ea7\u5b57\u6bb5",help:"\u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u6307\u5411\u7236\u7ea7\u8bb0\u5f55"},g.a.createElement(E["a"],{value:f.params.parent,onChange:function(e){return Y(t,"parent",e)}},n[m.ref].fields.filter(D["D"]).filter((function(e){return e.ref===m.ref})).map((function(e){return g.a.createElement(E["a"].Option,{value:e.name},e.displayName)})))),["GroupCascader"].includes(p)&&g.a.createElement(v["a"].Item,{label:"\u5206\u7ec4\u5b57\u6bb5",required:!0},g.a.createElement(k["a"],{value:f.params.groupBy,model:m.ref,onChange:function(e){return Y(t,"groupBy",e)},fieldFilter:D["D"]})),["Gallery"].includes(p)&&g.a.createElement(v["a"].Item,{label:"\u56fe\u7247\u5730\u5740\u5b57\u6bb5",help:"\u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u5b58\u653e\u56fe\u7247\u94fe\u63a5\u5730\u5740"},g.a.createElement(E["a"],{value:f.params.urlField,onChange:function(e){return Y(t,"urlField",e)}},n[m.ref].fields.filter((function(e){return["string","text","image","file"].includes(e.type)})).map((function(e){return g.a.createElement(E["a"].Option,{value:e.name},e.displayName)})))),[("InlineForm"===p||"InnerTable"===p||"Select"===p&&"mref"===m.type)&&g.a.createElement(v["a"].Item,{label:"\u5141\u8bb8\u65b0\u589e"},g.a.createElement(d["a"],{checked:f.params.canAdd,onChange:function(e){return Y(t,"canAdd",e.target.checked)}}))],"Select"===p&&(Object(D["C"])(m)||"mref"===m.type)&&g.a.createElement(v["a"].Item,{label:"\u9009\u9879\u4e2a\u6570",help:"\u4e0b\u62c9\u9009\u62e9\u6846\u9009\u62e9\u65f6\u663e\u793a\u7684\u4e2a\u6570"},g.a.createElement(s["a"],{min:1,placeholder:"\u9ed8\u8ba4\u4e3a7",value:f.params.optionSize,onChange:function(e){return Y(t,"optionSize",e)}})),(Object(D["D"])(m)||"mref"===m.type)&&g.a.createElement(v["a"].Item,{label:"\u8fc7\u6ee4\u6761\u4ef6\uff1a"},g.a.createElement(F["a"],{fields:n[m.ref].fields,onChange:function(e){return Q(t,e,"choicesFilter")},value:f.choicesFilter,disabledFilte:f.choicesFilter,context:{model:a},valueTypes:["\u6307\u5b9a\u503c","\u53ef\u53d8\u503c"]})),g.a.createElement("div",{className:T.a.divider,style:{marginBottom:16}},"\u6743\u9650\u8bbe\u7f6e"),g.a.createElement(P["a"],{groupsValue:null!==(c=null===(i=f.groups)||void 0===i?void 0:i.filter((function(e){return!("number"===typeof e)})))&&void 0!==c?c:[],groupsOnChange:function(n){var a=e.cloneDeep(u);a[t].groups=n,o(Object(b["a"])(a))},userValue:f.userField,userOnChange:function(n){var a=e.cloneDeep(u);a[t].userField=n,o(Object(b["a"])(a))},staffModelFields:O,staffModel:r,defauldGroupValue:l[a].formFields[t]}),g.a.createElement(v["a"].Item,{label:"\u6ee1\u8db3\u6761\u4ef6\u663e\u793a"},g.a.createElement(F["a"],{fields:A,onChange:function(e){return Q(t,e,"showIf")},value:f.showIf,disabledField:function(e){return f.showIf.filter((function(e){return e.field})).map((function(e){return e.field})).includes(e.name)},context:{model:a}})))}return[te,u,K,W,z,ee,x]}function B(e){var t=e.schemas,n=e.modelName,a=e.adminConfig,l=e.bsmSetting,r=Object(y["useState"])(String(0)),c=Object(h["a"])(r,2),i=c[0],u=c[1],s=J({schemas:t,modelName:n,adminConfig:a,bsmSetting:l}),d=Object(h["a"])(s,6),v=d[0],p=d[1],b=d[2],E=d[3],O=d[4],j=d[5],C=Object(x["a"])({modelName:n,schemas:t,adminConfig:a,formFields:p}),S=Object(h["a"])(C,3),w=S[0],k=S[1],N=S[2],F=j.handleAdd,D=j.handleDelete,I=t[n].fields;function P(){b(),N()}var V=g.a.createElement(g.a.Fragment,null,g.a.createElement(f["a"],{title:"\u8868\u5355\u5b57\u6bb5",type:"inner"},g.a.createElement(m["a"],{tabBarStyle:{minWidth:48},activeKey:i,tabPosition:"left",type:"editable-card",onChange:u,onEdit:function(e,t){switch(t){case"add":F(),u(String(p.length));break;case"remove":D(e);break;default:}}},p.map((function(e,t){var n=I.find((function(t){return t.name===e.name}));return g.a.createElement(m["a"].TabPane,{tab:(n||{}).displayName||"\u5b57\u6bb5".concat(t+1),key:t,closable:!n||!n.required||p.filter((function(t){return t.name===e.name})).length>=2},v(t))})))),g.a.createElement(o["a"],null),w);return[V,p,P,E,O,k]}function U(t){var n=t.modelName,a=t.adminConfig,r=t.schemas,o=t.bsmSetting,f=J({schemas:r,modelName:n,adminConfig:a,bsmSetting:o}),m=Object(h["a"])(f,7),s=m[0],d=m[1],v=m[2],p=m[3],E=m[4],O=m[5],j=m[6],C=Object(y["useState"])([d.length]),k=Object(h["a"])(C,2),N=k[0],F=k[1],D=Object(y["useState"])([]),I=Object(h["a"])(D,2),P=I[0],x=I[1],L=O.handleDelete,A=O.setFormFields,T=O.changeFieldName,B=O.getField;function U(e){var t=0,n=e.length+N[l];N.forEach((function(e,n){n<=l&&(t+=e)}));var a=e.map(B),r=S()(d,{$splice:[[t,0].concat(Object(b["a"])(a))]});A(r),F(S()(N,{$splice:[[l,1,n]]}))}var q,K=Object(V["d"])({modelName:n,schemas:r,onOk:function(){return U(R)},fieldDisabled:function(e){return d.map((function(e){return e.name})).includes(e.name)},expand:!1}),W=Object(h["a"])(K,3),$=W[0],R=W[1],H=W[2],X=a[n].formLayout,Z=Object(y["useState"])((null===X||void 0===X?void 0:X.style)||"default"),Q=Object(h["a"])(Z,2),Y=Q[0],_=Q[1];function z(e,t){L(Object(V["c"])(e,t,N)),F(S()(N,{$splice:[[t,1,N[t]-1]]}))}function ee(e){var t=N.reduce((function(t,n,a){return a<e?t+n:t}),0);A(S()(d,{$splice:[[t,N[e]]]})),F(S()(N,{$splice:[[e,1]]})),x(S()(P,{$splice:[[e,1]]}))}function te(e,t,n){T(Object(V["c"])(e,t,N),n)}function ne(e,t){x(S()(P,{$splice:[[e,1,t]]}))}function ae(e){_(e),"default"===e&&(F([d.length]),x([P[0]]))}function le(e){return 0!==e&&g.a.createElement(u["a"],{icon:"delete",onClick:function(){return ee(e)}},"\u5220\u9664")}function re(t){var n=e.cloneDeep(N);n.splice(t,0,0),F(n),x(S()(P,{$splice:[[t,0,null]]}))}function ce(){if(X&&"default"!==X.style&&!e.isEmpty(X.sections)){var t=[],n=[],a=[];X.sections.forEach((function(e){var l=[];e.fields.forEach((function(e){var t=d.find((function(t){return t.name===e}));t&&l.push(t)})),a.push.apply(a,l),n.push(l.length),e.title&&t.push(e.title)})),A(a),F(n),x(t)}}if(Object(y["useEffect"])((function(){j&&ce()}),[j]),"default"!==Y){q={style:Y,sections:[]};var ie=0;N.forEach((function(e,t){e&&(q.sections.push({title:P[t],fields:d.slice(ie,ie+e).map((function(e){return e.name}))}),ie+=e)}))}else q=void 0;function ue(){v(),ce()}var oe=g.a.createElement(V["b"],{sections:N,sectionTitles:P,setSections:F,allData:d,bordered:!1,setData:A,title:"\u8868\u5355\u5b57\u6bb5",modalView:$,columns:[{title:"\u5b57\u6bb5",key:"name",render:function(e,t,a,l){return g.a.createElement(M,{value:e.name,onChange:function(e){return te(a,l,e)},model:n,disabledField:function(t){return d.map((function(e){return e.name})).includes(t.name)&&t.name!==e.name},bordered:!1,dropdownMatchSelectWidth:!1,showSearch:!1})}},{title:"\u7ec4\u4ef6",key:"widget",render:function(e,t,a){var l=d[a],c=r[n].fields,i=c.find((function(e){return e.name===l.name}));return e.widget?w["a"][e.widget]||e.widget:"\u9ed8\u8ba4\uff08".concat(w["a"][w["e"][i.type]]||w["e"][i.type],"\uff09")}},{title:"\u64cd\u4f5c",key:"operation",render:function(e,t,n,a){return g.a.createElement("a",{onClick:function(){return z(n,a)}},"\u5220\u9664")}}],footer:function(e){return g.a.createElement(u["a"],{onClick:function(){l=e,H()}},"\u6dfb\u52a0\u5b57\u6bb5")},expandedRowRender:function(e,t,n,a,l){return s(Object(V["c"])(t,l,N))},addAndDeleteView:"default"!==Y?le:null,addAndWidget:function(e){return"default"!==Y&&g.a.createElement("div",null,g.a.createElement(u["a"],{type:"dashed",onClick:function(){return re(e+1)},block:!0},g.a.createElement(i["a"],{type:"plus"})))},styleView:function(){return g.a.createElement(V["a"],{onChange:ae,value:Y,layouts:G})},tableTitle:function(e){return"default"!==Y&&g.a.createElement("div",null,"".concat(G[Y],"\u540d\u79f0"),"\xa0\xa0",g.a.createElement(c["a"],{style:{width:100},value:P[e],onChange:function(t){return ne(e,t.target.value)},placeholder:"\u7b2c".concat(e+1,"\u7ec4")}))}});return[oe,d,ue,p,E,q]}var q=(a={},Object(r["a"])(a,L["b"],B),Object(r["a"])(a,L["c"],U),a);t["a"]=q[L["a"]]}).call(this,n("LvDl"))},Ol5k:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return j}));var a=n("k1fw"),l=(n("Ahcs"),n("k0dM")),r=(n("IzEo"),n("bx4M")),c=(n("2qtc"),n("kLXV")),i=(n("4X2C"),n("xvon")),u=n("tJVT"),o=n("oBTY"),f=n("q1tI"),m=n.n(f),s=n("WHYC"),d=n("4b23"),v=n.n(d),p=n("jfUH"),b=n("wiuW"),h=n("+dfd");function E(e,t){e(t)}function y(e,t,n,a){var l=Object(o["a"])(n);l[a].title=t,e(l)}var g=e.debounce(E,100),O=e.debounce(y,100);function j(t){var n,d=t.modelName,E=t.adminConfig,y=t.schemas,j=t.bsmSetting,C=Object(s["j"])(),S=C.params.key,w=function(){return Object(o["a"])(E[d].details||[])},k=Object(f["useState"])(w),N=Object(u["a"])(k,2),F=N[0],D=N[1],I=Object(f["useState"])(),P=Object(u["a"])(I,2),V=P[0],x=P[1],L=Object(f["useState"])(),A=Object(u["a"])(L,2),T=A[0],M=A[1],G=Object(f["useState"])(S||(null===(n=F[0])||void 0===n?void 0:n.key)),J=Object(u["a"])(G,2),B=J[0],U=J[1];Object(f["useEffect"])((function(){S&&U(S)}),[S]);var q=m.a.createElement("div",null,m.a.createElement(c["a"],{title:"\u6dfb\u52a0\u6807\u7b7e",visible:V,okButtonProps:{disabled:!T},destroyOnClose:!0,onOk:function(){var e=F,t=v()(6);e.push({key:t,sections:[],title:T,style:"group"}),D(e),U(t),x(!1)},onCancel:function(){return x(!1)}},m.a.createElement("span",null,"\u6807\u7b7e\u540d\u79f0\uff1a"),m.a.createElement(i["a"],{onChange:function(e){return g(M,e.target.value)},style:{width:300}})),m.a.createElement(l["a"],{type:"editable-card",activeKey:B,onChange:function(e){return U(e)},onEdit:function(e,t){if("add"===t&&x(!0),"remove"===t){var n,a,l=F.filter((function(t,n){return t.key!==e||(a=n-1,a<0&&(a=0),!1)}));e===B&&U(null===(n=l[a])||void 0===n?void 0:n.key),D(l)}}},F.map((function(e,t){return m.a.createElement(l["a"].TabPane,{tab:e.title||"\u8be6\u60c5".concat(t+1),key:e.key,closable:1!==F.length},m.a.createElement(r["a"],null,m.a.createElement("span",null,"\u6807\u7b7e\u540d\u79f0\uff1a"),m.a.createElement(i["a"],{onChange:function(e){return O(D,e.target.value,F,t)},style:{width:300},defaultValue:e.title||"\u8be6\u60c5".concat(t+1)})),m.a.createElement(h["a"],{modelName:d,schemas:y,detailValue:e,bsmSetting:j,onChange:function(e){var n=F;n[t]=e,D(n)}}))}))));function K(){var e;U(null!==S&&void 0!==S?S:null===(e=F[0])||void 0===e?void 0:e.key),D(w())}function W(t){var n=t;function l(t){return t.map((function(t){return e.isString(t)?{name:t}:t})).filter((function(e){return e.name})).map((function(t){var n=Object(a["a"])({},t);return n.showIf&&(n.showIf=Object(p["F"])(t.showIf,d)),e.isEmpty(t.groups)||(n.groups=n.groups.filter((function(e){return e})).map((function(e){return e.id||e}))),t.id||(n.id=v()(6)),n}))}return"default"!==t.style&&t.sections?n.sections=n.sections.filter((function(t){var n;return(null===(n=t.style)||void 0===n?void 0:n.widget)in b["c"]||!e.isEmpty(t.fields)})).map((function(e){var t,n=e;return(null===(t=e.style)||void 0===t?void 0:t.widget)in b["c"]?n.fields=[]:n.fields=l(n.fields),n})):n.fields=l(n.fields),n}function $(){return F.map((function(e){return W(e)}))}return[q,void 0,F,K,$]}}).call(this,n("LvDl"))},hzhw:function(e,t,n){"use strict";(function(e){n("Dvpn");var a=n("myml"),l=(n("eNCU"),n("pjJH")),r=n("oBTY"),c=(n("QjdF"),n("U4Vl")),i=(n("yavW"),n("WuMn")),u=(n("4X2C"),n("xvon")),o=(n("vmZS"),n("NjVP")),f=(n("6dnR"),n("CQJL")),m=n("tJVT"),s=n("q1tI"),d=n.n(s),v={group:"\u5206\u7ec4",tab:"\u6807\u7b7e",step:"\u5206\u6b65"};function p(t){var n=t.schemas,p=t.modelName,b=t.adminConfig,h=t.formFields,E="default",y=[];b[p].formLayout&&(E=b[p].formLayout.style||E,y=e.cloneDeep(b[p].formLayout.sections));var g=Object(s["useState"])(E),O=Object(m["a"])(g,2),j=O[0],C=O[1],S=Object(s["useState"])(y),w=Object(m["a"])(S,2),k=w[0],N=w[1];function F(t,n){var a=e.cloneDeep(k);a[t].title=n,N(a)}function D(t,n){var a=e.cloneDeep(k);a[t].fields=n,N(a)}function I(){C(E),N(y)}function P(t){var n=e.cloneDeep(k);n.splice(t,1),N(n)}function V(t){var n=e.cloneDeep(k),a=t-1,l=[n[t],n[a]];n[a]=l[0],n[t]=l[1],N(n)}function x(t){var n=e.cloneDeep(k),a=t+1,l=[n[t],n[a]];n[a]=l[0],n[t]=l[1],N(n)}var L=d.a.createElement(o["a"],{layout:"inline"},d.a.createElement(o["a"].Item,{label:"\u6392\u5217\u65b9\u5f0f"},d.a.createElement(f["a"].Group,{value:j,onChange:function(e){return C(e.target.value)}},d.a.createElement(f["a"],{value:"default"},"\u9ed8\u8ba4"),e.map(v,(function(e,t){return d.a.createElement(f["a"],{value:t},e)})))),"default"!==j&&d.a.createElement(d.a.Fragment,null,d.a.createElement(a["a"],{style:{marginTop:24},size:"middle",bordered:!0,dataSource:k,pagination:!1,columns:[{title:"".concat(v[j],"\u540d\u79f0"),key:"title",render:function(e,t,n){return d.a.createElement(u["a"],{value:e.title,onChange:function(e){return F(n,e.target.value)}})}},{title:"\u6240\u542b\u5b57\u6bb5",key:"fields",render:function(e,t,a){return d.a.createElement(i["a"],{mode:"multiple",value:e.fields,onChange:function(e){return D(a,e)}},h.filter((function(e){return e.name})).map((function(t){return d.a.createElement(i["a"].Option,{value:t.name,disabled:k.map((function(e){return e.fields})).flat().includes(t.name)&&!(e.fields||[]).includes(t.name)},n[p].fields.find((function(e){return e.name===t.name})).displayName)})))}},{title:"\u64cd\u4f5c",key:"option",render:function(e,t,n){return d.a.createElement(d.a.Fragment,null,d.a.createElement("a",{onClick:function(){return P(n)}},"\u5220\u9664"),n>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement(c["a"],{type:"vertical"}),d.a.createElement("a",{onClick:function(){return V(n)}},"\u4e0a\u79fb")),n<k.length-1&&d.a.createElement(d.a.Fragment,null,d.a.createElement(c["a"],{type:"vertical"}),d.a.createElement("a",{onClick:function(){return x(n)}},"\u4e0b\u79fb")))}}],footer:function(){return d.a.createElement(l["a"],{onClick:function(){return N([].concat(Object(r["a"])(k),[{}]))}},"\u6dfb\u52a0",v[j])}}))),A={style:j,sections:k};return[L,"default"===j?void 0:A,I]}t["a"]=p}).call(this,n("LvDl"))},uKwZ:function(e,t,n){"use strict";(function(e){n("SePM");var a=n("PMX6"),l=(n("UvA9"),n("u4G2")),r=(n("6dnR"),n("CQJL")),c=(n("vmZS"),n("NjVP")),i=(n("4X2C"),n("xvon")),u=(n("GPKB"),n("mFAc")),o=n("k1fw"),f=n("oBTY"),m=(n("c94q"),n("Y/eX")),s=n("tJVT"),d=n("q1tI"),v=n.n(d),p=n("LvDl"),b=n("jfUH"),h={version:"v2",name:"",file_type:"csv",merge_bref:!1,fields:[],collapseActiveKey:[]};function E(t){var n=t.modelName,E=t.adminConfig,y=t.schemas,g=Object(d["useState"])(e.cloneDeep(E[n].exportable)||h),O=Object(s["a"])(g,2),j=O[0],C=O[1],S=Object(d["useState"])("success"),w=Object(s["a"])(S,2),k=w[0],N=w[1],F=Object(d["useState"])(j.collapseActiveKey||[]),D=Object(s["a"])(F,2),I=D[0],P=D[1],V=Object(d["useState"])([]),x=Object(s["a"])(V,2),L=x[0],A=x[1],T=Object(d["useState"])([]),M=Object(s["a"])(T,2),G=M[0],J=M[1],B=Object(d["useState"])([]),U=Object(s["a"])(B,2),q=U[0],K=U[1],W=m["a"].Panel;function $(){C(E[n].exportable||h)}function R(e,t){var n=Object(f["a"])(j.fields||[]);t?n.includes(e)||n.push(e):n=n.filter((function(t){return t!==e})),C(Object(o["a"])(Object(o["a"])({},j),{},{fields:n}))}function H(e,t){var n=I||[];e.length>0?n.includes(t)||n.push(t):n=n.filter((function(e){return e!==t})),P(n)}function X(){return j.collapseActiveKey=I,C(j),!!Object(p["isEmpty"])(j.fields)||(!!j.name||(N("error"),u["a"].error("\u8bf7\u8f93\u5165\u5bfc\u51fa\u914d\u7f6e\u7684\u540d\u79f0"),!1))}Object(d["useEffect"])((function(){var e=[],t=[],a=[];y[n].fields.forEach((function(n){if(Object(b["D"])(n)){var l=n,r=[];y[n.ref].fields.forEach((function(e){Object(b["B"])(e)||r.push({displayName:e.displayName,name:e.name})})),t.push({parenField:l,fieldxs:r})}else if("bref"===n.type||"mref"===n.type){var c=n,i=[],u=[];y[n.ref]&&y[n.ref].fields.forEach((function(e){if(Object(b["B"])(e)){if(Object(b["D"])(e)){var t=e,n=[];y[e.ref].fields.forEach((function(e){Object(b["B"])(e)||n.push({displayName:e.displayName,name:e.name})})),u.push({shildParenField:t,shildDieldxs:n})}}else i.push({displayName:e.displayName,name:e.name})})),a.push({parenField:c,fieldxs:i,shildRefFiledsData:u})}else e.push({displayName:n.displayName,name:n.name})})),A(e),J(t),K(a)}),[]);var Z={background:"white",border:0},Q={labelCol:{xs:{span:18},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}},Y=v.a.createElement(c["a"],Q,v.a.createElement(c["a"].Item,{label:"\u540d\u79f0\uff1a",required:!0,validateStatus:k},v.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165\u5bfc\u51fa\u6309\u94ae\u7684\u540d\u79f0",onChange:function(e){var t=e.target.value;""===t&&N("error"),C(Object(o["a"])(Object(o["a"])({},j),{},{name:t}))},value:j.name})),v.a.createElement(c["a"].Item,{label:"\u683c\u5f0f\uff1a"},v.a.createElement(r["a"].Group,{value:j.file_type,onChange:function(e){var t=e.target.value;C(Object(o["a"])(Object(o["a"])({},j),{},{file_type:t}))}},v.a.createElement(r["a"],{value:"csv"},"CSV"),v.a.createElement(r["a"],{value:"excel"},"Excel"))),v.a.createElement(c["a"].Item,{label:"\u5408\u5e76\u5b50\u9879\uff1a"},v.a.createElement(r["a"].Group,{value:j.merge_bref||!1,onChange:function(e){var t=e.target.value;C(Object(o["a"])(Object(o["a"])({},j),{},{merge_bref:t}))}},v.a.createElement(r["a"],{value:!0},"\u662f"),v.a.createElement(r["a"],{value:!1},"\u5426")),v.a.createElement("br",null),"\u5408\u5e76\u5b50\u9879\u4f1a\u628a\u591a\u6761\u5b50\u9879\u7684\u6570\u636e\u62fc\u63a5\u6210\u4e00\u6761\u6765\u663e\u793a\u3002"),v.a.createElement(c["a"].Item,null,v.a.createElement(a["a"],{bordered:!1,title:"\u5bfc\u51fa\u5b57\u6bb5\uff1a",style:{marginLeft:30,width:770}},v.a.createElement("div",{style:{marginLeft:70}},v.a.createElement(l["a"].Group,{value:j.fields},L.map((function(e){return v.a.createElement(l["a"],{onChange:function(t){R(e.name,t.target.checked)},style:{marginLeft:8},value:e.name},e.displayName)}))),G.map((function(e){var t=e.parenField,n=e.fieldxs;return v.a.createElement(m["a"],{style:{border:0},defaultActiveKey:j.collapseActiveKey},v.a.createElement(W,{header:"".concat(t.displayName,"(\u7236\u9879)"),key:t.displayName,style:Z},v.a.createElement(l["a"].Group,{value:j.fields,onChange:function(e){H(e,t.displayName)}},n.map((function(e){return v.a.createElement(l["a"],{onChange:function(e){var t=e.target,n=t.value,a=t.checked;R(n,a)},value:"".concat(t.name,".").concat(e.name),style:{marginLeft:8}},"".concat(t.displayName,".").concat(e.displayName))})))))})),q&&q.map((function(e){var t=e.parenField,n=e.fieldxs,a=e.shildRefFiledsData;return v.a.createElement(m["a"],{style:{border:0},defaultActiveKey:j.collapseActiveKey},v.a.createElement(W,{header:"".concat(t.displayName,"(\u5b50\u9879)"),key:t.displayName,style:Z},v.a.createElement(l["a"].Group,{value:j.fields,onChange:function(e){H(e,t.displayName)}},n.map((function(e){return v.a.createElement(l["a"],{onChange:function(e){var t=e.target,n=t.value,a=t.checked;R(n,a)},value:"".concat(t.name,".").concat(e.name),style:{marginLeft:8}},"".concat(t.displayName,".").concat(e.displayName))}))),a&&a.map((function(e){var n=e.shildParenField,a=e.shildDieldxs;return v.a.createElement(m["a"],{style:{border:0,marginLeft:20},defaultActiveKey:j.collapseActiveKey},v.a.createElement(W,{header:"".concat(t.displayName,".").concat(n.displayName,"(\u7236\u9879)"),key:"".concat(t.displayName,".").concat(n.displayName),style:Z},v.a.createElement(l["a"].Group,{value:j.fields,onChange:function(e){H(e,"".concat(t.displayName,".").concat(n.displayName))}},a.map((function(e){return v.a.createElement(l["a"],{onChange:function(e){var t=e.target,n=t.value,a=t.checked;R(n,a)},value:"".concat(t.name,".").concat(n.name,".").concat(e.name),style:{marginLeft:8}},"".concat(t.displayName,".").concat(n.displayName,".").concat(e.displayName))})))))}))))}))))));return[Y,j,$,X]}t["a"]=E}).call(this,n("LvDl"))},yPhJ:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"AdminEditorCard",(function(){return E})),n.d(t,"useAdminEditor",(function(){return y})),n.d(t,"AdminEditorButtons",(function(){return g}));n("eNCU");var a=n("pjJH"),l=n("9og8"),r=n("k1fw"),c=(n("SePM"),n("PMX6")),i=n("tJVT"),u=n("WmNS"),o=n.n(u),f=n("q1tI"),m=n.n(f),s=n("txBY"),d=n("jfUH"),v=n("uKwZ"),p=n("Evl9"),b=n("D27F"),h=n("LK96");function E(t){var n=t.actions,a=t.defaultTab,l=void 0===a?"list":a,r=t.tabs,u=Object(f["useState"])(l),o=Object(i["a"])(u,2),s=o[0],d=o[1];return m.a.createElement(c["a"],{activeTabKey:s,tabList:e.map(r,(function(e,t){var n=e.displayName;return{key:t,tab:n}})),onTabChange:d,actions:n},r[s].view)}function y(t){var n=t.modelName,a=Object(d["ub"])(),l=Object(d["U"])(),c=Object(d["W"])(),u=Object(p["b"])({modelName:n,schemas:a,adminConfig:l,bsmSetting:c}),o=Object(i["a"])(u,4),f=o[0],s=o[1],E=o[2],y=o[3],g=Object(b["a"])({modelName:n,schemas:a,adminConfig:l,bsmSetting:c}),O=Object(i["a"])(g,5),j=O[0],C=O[1],S=O[2],w=O[3],k=O[4],N=Object(h["a"])({modelName:n,schemas:a,adminConfig:l,bsmSetting:c}),F=Object(i["a"])(N,4),D=F[0],I=F[1],P=F[2],V=F[3],x=Object(v["a"])({modelName:n,schemas:a,adminConfig:l}),L=Object(i["a"])(x,4),A=L[0],T=L[1],M=L[2],G=L[3],J=Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({},l[n]),{},{exportable:T},f),C),I),B=function(){return e.mapValues(E(),(function(e,t){J[t]=e})),e.mapValues(w(),(function(e,t){J[t]=e})),e.mapValues(V(),(function(e,t){J[t]=e})),J};function U(){M(),s(n,l),S(),P()}function q(){return k()&&G()}var K=m.a.createElement(p["a"],y),W={list:{view:K,displayName:"\u5217\u8868\u9875\u8bbe\u7f6e"},form:{view:j,displayName:"\u8868\u5355\u8bbe\u7f6e"},detail:{view:D,displayName:"\u8be6\u60c5\u9875\u8bbe\u7f6e"},export:{view:A,displayName:"\u5bfc\u51fa\u8bbe\u7f6e"}};return{check:B,reset:U,verifys:q,conf:J,tabs:W}}function g(t){var n=t.check,r=t.reset,c=t.verifys,u=t.conf,s=t.updateAdmin,d=t.afterSubmit,v=t.modelName,p=Object(f["useState"])(!1),b=Object(i["a"])(p,2),h=b[0],E=b[1];return m.a.createElement("div",{style:{textAlign:"left",marginTop:12,marginBottom:12}},m.a.createElement(a["a"],{loading:h,onClick:Object(l["a"])(o.a.mark((function t(){var a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!c()){t.next=11;break}return n(),a=e.cloneDeep(u),t.prev=3,E(!0),t.next=7,s({model:v,config:a});case 7:d&&d({model:v,config:a});case 8:return t.prev=8,E(!1),t.finish(8);case 11:case"end":return t.stop()}}),t,null,[[3,,8,11]])}))),type:"primary",style:{marginLeft:24}},"\u66f4\u65b0"),m.a.createElement(a["a"],{onClick:r,style:{marginLeft:24}},"\u91cd\u7f6e"))}function O(e){var t=e.modelName,n=e.updateAdmin,a=e.afterSubmit,l=e.defaultTab,r=void 0===l?"list":l,c=y({modelName:t}),i=c.check,u=c.reset,o=c.verifys,f=c.conf,s=c.tabs;return m.a.createElement(E,{actions:[m.a.createElement(g,{modelName:t,conf:f,check:i,reset:u,verifys:o,updateAdmin:n,afterSubmit:a})],defaultTab:r,tabs:s})}var j=Object(s["a"])(O);t["default"]=function(e){var t=e.modelName,n=Object(d["rb"])(t);return n?m.a.createElement(j,e):null}}.call(this,n("LvDl"))}}]);